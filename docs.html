<html>
	<head>
		<title>JomohoJS</title>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
		<style>body {
    margin: 0;
    padding: 0;
    font: 14px/1.5 'Palatino Linotype', 'Book Antiqua', Palatino, FreeSerif, serif;
    color: #252519;
}
a {
    color: #252519;
}
a:hover {
    text-decoration: underline;
    color: #19469D;
}
p {
    margin: 12px 0;
}
h1, h2, h3 {
    margin: 0;
    padding: 0;
}
table#source {
    width: 100%;
    border-collapse: collapse;
}
table#source td:first-child {
    padding: 30px 40px 30px 40px;
    vertical-align: top;
}
table#source td:first-child,
table#source td:first-child pre {
    width: 450px;
}
table#source td:last-child {
    padding: 30px 0 30px 40px;
    border-left: 1px solid #E5E5EE;
    background: #F5F5FF;
}
table#source tr {
    border-bottom: 1px solid #E5E5EE;
}
table#source tr.filename {
    padding-top: 40px;
    border-top: 1px solid #E5E5EE;
}
table#source tr.filename td:first-child {
    text-transform: capitalize;
}
table#source tr.filename td:last-child {
    font-size: 12px;
}
table#source tr.filename h2 {
    margin: 0;
    padding: 0;
    cursor: pointer;
}
table#source tr.code h1,
table#source tr.code h2,
table#source tr.code h3 {
    margin-top: 30px;
    font-family: "Lucida Grande", "Helvetica Nueue", Arial, sans-serif;
    font-size: 18px;
}
table#source tr.code h2 {
    font-size: 16px;
}
table#source tr.code h3 {
    font-size: 14px;
}
table#source tr.code ul {
    margin: 15px 0 15px 35px;
    padding: 0;
}
table#source tr.code ul li {
    margin: 0;
    padding: 1px 0;
}
table#source tr.code ul li p {
    margin: 0;
    padding: 0;
}
table#source tr.code td:first-child pre {
    padding: 20px;
}
#ribbon {
    position: fixed;
    top: 0;
    right: 0;
}
code .string { color: #219161; }
code .regexp { color: #219161; }
code .keyword { color: #954121; }
code .number { color: #19469D; }
code .comment { color: #bbb; }
code .this { color: #19469D; }</style>
		<script>
			$(function(){
				$('tr.code').hide();
				$('tr.filename').toggle(function(){
					$(this).nextUntil('.filename').fadeIn();
				}, function(){
					$(this).nextUntil('.filename').fadeOut();
				});
			});
		</script>
	</head>
	<body>
<table id="source"><tbody><tr><td><h1>JomohoJS</h1><p>Game Development Framework</p></td><td></td></tr><tr class="filename"><td><h2 id="Animation.js"><a href="#">Animation</a></h2></td><td>Animation.js</td></tr><tr class="code">
<td class="docs">
<p>define(['./jo'], function(jo){</p>
</td>
<td class="code">
<pre><code>*
	 * @<span class="keyword">class</span> <span class="variable">defines</span> <span class="variable">an</span> <span class="variable">animation</span>, <span class="variable">needs</span> <span class="variable">a</span> <span class="variable">sprite</span> <span class="variable">as</span> <span class="variable">frame</span> <span class="variable">set</span>,
	 * 			<span class="variable">define</span> <span class="variable">the</span> <span class="variable">frames</span>' <span class="variable">index</span> <span class="variable">and</span> <span class="variable">length</span> <span class="keyword">in</span> <span class="variable">milliseconds</span> <span class="variable">and</span> <span class="variable">call</span> <span class="variable">run</span> <span class="variable">every</span> <span class="variable">frame</span>.
	 * 			<span class="class">For</span> <span class="variable">now</span> <span class="variable">it</span> <span class="variable">only</span> <span class="variable">takes</span> <span class="variable">frames</span> <span class="keyword">in</span> <span class="variable">vertical</span> <span class="variable">direction</span>
	 * 
	 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>jo.Animation = jo.Class.extend({</p>
</td>
<td class="code">
<pre><code>*
		 * @<span class="variable">constructor</span>
		 * @<span class="variable">param</span> {<span class="variable">jo</span>.<span class="class">Sprite</span>} <span class="variable">sprite</span> <span class="variable">the</span> <span class="variable">frame</span> <span class="variable">set</span>
		 * @<span class="variable">param</span> {<span class="variable">array</span>} <span class="variable">frames</span> <span class="variable">as</span>  {<span class="variable">i</span>: {<span class="variable">number</span>} <span class="variable">frameIndex</span>, <span class="variable">t</span>: {<span class="variable">number</span>} <span class="variable">time</span> <span class="keyword">in</span> <span class="variable">ms</span>}
		 * <span class="variable">or</span> <span class="variable">just</span> <span class="variable">time</span> <span class="keyword">in</span> <span class="variable">milliseconds</span>
		 * @<span class="variable">param</span> {<span class="variable">number</span>} <span class="variable">width</span> <span class="variable">width</span> <span class="variable">of</span> <span class="variable">one</span> <span class="variable">frame</span> 
		 * @<span class="variable">param</span> {<span class="variable">number</span>} <span class="variable">height</span> <span class="variable">height</span> <span class="variable">of</span> <span class="variable">one</span> <span class="variable">frame</span>
		 * @<span class="variable">methodOf</span> <span class="variable">jo</span>.<span class="class">Animation</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>init: function(frames, width, height, sprite, startCallback, finishCallback){
			this.sprite = (sprite) ? sprite : null;
			this.width = (width) ? width : 0;
			this.height = (height) ? height : 0;
			this.xoff = 0;
			this.yoff = 0;
			this.frames = this.readFrames(frames);
			this.frame = 0;
			this.tickCount = 0;
			this.startCallback = startCallback;
			this.finishCallback = finishCallback;
			this.start = true;
		},</p>
</td>
<td class="code">
<pre><code>*
		 * <span class="variable">reads</span> <span class="variable">and</span> <span class="variable">transforms</span> <span class="variable">an</span> <span class="variable">array</span> <span class="variable">of</span> <span class="variable">frames</span>
		 * @<span class="variable">param</span> <span class="variable">frames</span>
		 * @<span class="variable">returns</span> <span class="variable">the</span> <span class="variable">transformed</span> <span class="variable">frames</span> <span class="variable">array</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>readFrames: function(frames){
			if(typeof frames === 'undefined'){
				frames = [100];
			}
			if(typeof frames.length !== 'undefined'){
				for(var i=0; i&lt; frames.length; i++){
					frames[i] = typeof frames[i] === 'object'? frames[i] : {i: i, t: frames[i]};</p>

<pre><code>				frames[i].drawFrame = this.calcFrame(frames[i].i);

			}
		}
		return frames;
	},</code></pre>
</td>
<td class="code">
<pre><code>*
		 * @<span class="variable">description</span> <span class="variable">call</span> <span class="variable">to</span> <span class="variable">advance</span> <span class="variable">the</span> <span class="variable">animation</span>
		 * @<span class="variable">param</span> {<span class="variable">number</span>} <span class="variable">ticks</span> <span class="variable">milliseconds</span> <span class="variable">to</span> <span class="variable">advance</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>update: function(ticks){
			if(this.start === true ){
				if(typeof this.startCallback === 'function'){
					this.startCallback(this);
				}
				this.frame = this.frame % this.frames.length;
			}
			this.tickCount += ticks;
			if(this.frames[this.frame].t - this.tickCount &lt;= 0 ){
				this.tickCount -= this.frames[this.frame].t;
				this.frame +=1;				
			}</p>

<pre><code>		if(this.frame &gt;= this.frames.length ){
			if(typeof this.finishCallback === 'function'){
				this.finishCallback(this);
			}
			this.start = true;
			this.frame = this.frame % this.frames.length;
		}
	},</code></pre>
</td>
<td class="code">
<pre><code>*
		 * @<span class="variable">description</span> <span class="variable">draw</span> <span class="variable">the</span> <span class="variable">current</span> <span class="variable">frame</span>, <span class="variable">same</span> <span class="variable">parameters</span> <span class="variable">as</span> <span class="variable">jo</span>.<span class="class">Sprite</span>
		 * @<span class="variable">param</span> <span class="variable">surface</span>
		 * @<span class="variable">param</span> <span class="variable">position</span>
		 * @<span class="variable">param</span> <span class="variable">options</span>
		 * @<span class="variable">see</span> <span class="variable">jo</span>.<span class="class">Sprite</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>draw: function(options, position, surface){
			if(this.sprite){
				options.frame = this.frames[this.frame].drawFrame;
				this.sprite.draw(options, position, surface);
			}
		},</p>
</td>
<td class="code">
<pre><code>*
		 * <span class="variable">returns</span> <span class="variable">a</span> <span class="variable">frame</span> <span class="variable">rectangle</span> <span class="keyword">for</span> <span class="variable">use</span> <span class="keyword">with</span> <span class="variable">jo</span>.<span class="class">Sprite</span>.<span class="variable">draw</span>
		 * @<span class="variable">param</span> <span class="variable">frame</span>
		 * @<span class="variable">returns</span> {<span class="class">Object</span>}
		 * @<span class="variable">see</span> <span class="variable">jo</span>.<span class="class">Sprite</span>.<span class="variable">draw</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>calcFrame: function(frame){</p>

<pre><code>		var cols = Math.floor(this.sprite.width / this.width);
		return {
			x: this.xoff + ((frame % cols)) * this.width,
			y: this.yoff + Math.floor(frame / cols) * this.height, 
			width: this.width, 
			height: this.height				
		};
	},
	getDrawFrame: function(frame){
		if(!frame){
			frame=0;
		}
		return this.frames[frame].drawFrame;
	}
});
return jo.Animation;</code></pre>

<p>});</p>
</td>
<td class="code">

</td>
</tr><tr class="filename"><td><h2 id="Behaviour.js"><a href="#">Behaviour</a></h2></td><td>Behaviour.js</td></tr><tr class="code">
<td class="docs">
<p>define(['jo', 'Class'],function(jo, Class){
</p>

<pre><code>jo.Behaviour = Class.extend({</code></pre>

<p>
		joObject: 'Behaviour',
		isBehaviour: true,
		init: function(){
			this.joObject = this.joObject;
			this.arguments = arguments;
		},		
		setup: function(obj){
</p>

<pre><code>	},</code></pre>

<p>
		update: function(time){
</p>

<pre><code>	},</code></pre>

<p>
		postUpdate: function(time){
</p>

<pre><code>	},</code></pre>

<p>
		draw: function(opt, pos, srf){
</p>

<pre><code>	},</code></pre>

<p>
		postDraw: function(opt, pos, srf){
</p>

<pre><code>	}</code></pre>

<p>
	});
</p>

<pre><code>return jo.Behaviour;</code></pre>

<p>
});</p>
</td>
<td class="code">

</td>
</tr><tr class="filename"><td><h2 id="Camera.js"><a href="#">Camera</a></h2></td><td>Camera.js</td></tr><tr class="code">
<td class="docs">
<p>Camera class keeps track of the current 
drawing position
 </p>
</td>
<td class="code">
<pre><code><span class="variable">define</span>([<span class="string">'./jo'</span>,<span class="string">'./Point'</span>], 
        <span class="keyword">function</span>(<span class="variable">jo</span>, 
        		<span class="class">Point</span>){

	<span class="variable">jo</span>.<span class="class">Camera</span> = <span class="class">Point</span>.<span class="variable">extend</span>({
		<span class="variable">init</span>: <span class="keyword">function</span>(){
			<span class="this">this</span>.<span class="variable">_super</span>(<span class="number integer">0</span>,<span class="number integer">0</span>);
		},
		<span class="variable">toScreen</span>: <span class="keyword">function</span>(<span class="variable">p</span>){
			<span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="variable">p</span> ==<span class="string">'undefined'</span>){
				<span class="keyword">return</span> <span class="this">this</span>.<span class="variable">neg</span>();
			}
			<span class="keyword">return</span> <span class="variable">p</span>.<span class="variable">minus</span>(<span class="this">this</span>);
		},
		<span class="variable">toWorld</span>: <span class="keyword">function</span>(<span class="variable">p</span>){
			<span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="variable">p</span> ==<span class="string">'undefined'</span>){
				<span class="keyword">return</span> <span class="this">this</span>;
			}
			<span class="keyword">return</span> <span class="variable">p</span>.<span class="variable">plus</span>(<span class="this">this</span>);
		},

		<span class="variable">toMap</span>: <span class="keyword">function</span>(<span class="variable">p</span>){
			<span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="variable">p</span> ==<span class="string">'undefined'</span>){
				<span class="keyword">return</span> <span class="keyword">null</span>;
			}
			<span class="keyword">var</span> <span class="variable">p</span>= <span class="this">this</span>.<span class="variable">toWorld</span>(<span class="variable">p</span>);
			<span class="variable">p</span>.<span class="variable">x</span>/=<span class="variable">jo</span>.<span class="variable">game</span>.<span class="variable">map</span>.<span class="variable">tileSet</span>.<span class="variable">width</span>;
			<span class="variable">p</span>.<span class="variable">y</span>/=<span class="variable">jo</span>.<span class="variable">game</span>.<span class="variable">map</span>.<span class="variable">tileSet</span>.<span class="variable">height</span>;
			<span class="keyword">return</span> <span class="variable">p</span>.<span class="variable">floor</span>();
		},
		<span class="variable">parrallax</span>: <span class="keyword">function</span>(<span class="variable">val</span>, <span class="variable">width</span>, <span class="variable">height</span>){
			<span class="keyword">var</span> <span class="variable">para</span> = <span class="this">this</span>.<span class="variable">mul</span>(<span class="variable">val</span>);
			<span class="variable">para</span>.<span class="variable">x</span> = <span class="variable">para</span>.<span class="variable">x</span> % <span class="variable">width</span>;
			<span class="variable">para</span>.<span class="variable">y</span> = <span class="variable">para</span>.<span class="variable">y</span> % <span class="variable">height</span>;
			<span class="keyword">return</span> <span class="variable">para</span>.<span class="variable">negate</span>();
		}
	});
	<span class="keyword">return</span> <span class="variable">jo</span>.<span class="class">Camera</span>;
});</code></pre>
</td>
</tr><tr class="filename"><td><h2 id="Class.js"><a href="#">Class</a></h2></td><td>Class.js</td></tr><tr class="code">
<td class="docs">
<p> Simple JavaScript Inheritance
By John Resig http://ejohn.org/
MIT Licensed.
 </p>
</td>
<td class="code">
<pre><code><span class="comment">// Inspired by base2 and Prototype</span>



<span class="variable">define</span>( <span class="keyword">function</span>(){
  <span class="keyword">var</span> <span class="variable">initializing</span> = <span class="variable">false</span>, <span class="variable">fnTest</span> = <span class="regexp">/xyz/</span>.<span class="variable">test</span>(<span class="keyword">function</span>(){<span class="variable">xyz</span>;}) ? <span class="regexp">/\b_super\b/</span> : <span class="regexp">/.*/</span>;

  <span class="comment">// The base Class implementation (does nothing)</span></code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<ul><li><strong>class</strong>: <em>Base</em>
Class, featuring inheritance</li></ul>
</td>
<td class="code">
<pre><code><span class="keyword">var</span> <span class="class">Class</span> = <span class="keyword">function</span>(){};
 
  <span class="comment">// Create a new Class that inherits from this class</span></code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>extending is really easy
   </p>
</td>
<td class="code">
<pre><code><span class="class">Class</span>.<span class="variable">extend</span> = <span class="keyword">function</span>(<span class="variable">prop</span>) {
    <span class="keyword">var</span> <span class="variable">_super</span> = <span class="this">this</span>.<span class="variable">prototype</span>;
   
    <span class="comment">// Instantiate a base class (but only create the instance,</span>
    <span class="comment">// don't run the init constructor)</span>
    <span class="variable">initializing</span> = <span class="variable">true</span>;
    <span class="keyword">var</span> <span class="variable">prototype</span> = <span class="keyword">new</span> <span class="this">this</span>();
    <span class="variable">initializing</span> = <span class="variable">false</span>;
   
    <span class="comment">// Copy the properties over onto the new prototype</span>
    <span class="keyword">for</span> (<span class="keyword">var</span> <span class="variable">name</span> <span class="keyword">in</span> <span class="variable">prop</span>) {
      <span class="comment">// Check if we're overwriting an existing function</span>
      <span class="variable">prototype</span>[<span class="variable">name</span>] = <span class="keyword">typeof</span> <span class="variable">prop</span>[<span class="variable">name</span>] == &<span class="variable">quot</span>;<span class="keyword">function</span>&<span class="variable">quot</span>; &<span class="variable">amp</span>;&<span class="variable">amp</span>;
        <span class="keyword">typeof</span> <span class="variable">_super</span>[<span class="variable">name</span>] == &<span class="variable">quot</span>;<span class="keyword">function</span>&<span class="variable">quot</span>; &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">fnTest</span>.<span class="variable">test</span>(<span class="variable">prop</span>[<span class="variable">name</span>]) ?
        (<span class="keyword">function</span>(<span class="variable">name</span>, <span class="variable">fn</span>){
          <span class="keyword">return</span> <span class="keyword">function</span>() {
            <span class="keyword">var</span> <span class="variable">tmp</span> = <span class="this">this</span>.<span class="variable">_super</span>;
           
            <span class="comment">// Add a new ._super() method that is the same method</span>
            <span class="comment">// but on the super-class</span>
            <span class="this">this</span>.<span class="variable">_super</span> = <span class="variable">_super</span>[<span class="variable">name</span>];
           
            <span class="comment">// The method only need to be bound temporarily, so we</span>
            <span class="comment">// remove it when we're done executing</span>
            <span class="keyword">var</span> <span class="variable">ret</span> = <span class="variable">fn</span>.<span class="variable">apply</span>(<span class="this">this</span>, <span class="variable">arguments</span>);       
            <span class="this">this</span>.<span class="variable">_super</span> = <span class="variable">tmp</span>;
           
            <span class="keyword">return</span> <span class="variable">ret</span>;
          };
        })(<span class="variable">name</span>, <span class="variable">prop</span>[<span class="variable">name</span>]) :
        <span class="variable">prop</span>[<span class="variable">name</span>];
    }
   
    <span class="comment">// The dummy class constructor</span>
    <span class="keyword">function</span> <span class="class">Class</span>() {
      <span class="comment">// All construction is actually done in the init method</span>
      <span class="keyword">if</span> ( !<span class="variable">initializing</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="this">this</span>.<span class="variable">init</span> )
        <span class="this">this</span>.<span class="variable">init</span>.<span class="variable">apply</span>(<span class="this">this</span>, <span class="variable">arguments</span>);
    }
   
    <span class="comment">// Populate our constructed prototype object</span>
    <span class="class">Class</span>.<span class="variable">prototype</span> = <span class="variable">prototype</span>;
   
    <span class="comment">// Enforce the constructor to be what we expect</span>
    <span class="class">Class</span>.<span class="variable">constructor</span> = <span class="class">Class</span>;

    <span class="comment">// And make this class extendable</span>
    <span class="class">Class</span>.<span class="variable">extend</span> = <span class="variable">arguments</span>.<span class="variable">callee</span>;</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>copies all the members of obj into the class
 - <strong>param</strong>: <em>obj</em>
 the object which holds the variables we want to adapt
 - <strong>param</strong>: <em>recoursive</em>
 true if we want to copy recoursively into Objects. default: false
 - <strong>param</strong>: <em>func</em>
 true if we want to copy functions. default: false
     </p>
</td>
<td class="code">
<pre><code><span class="class">Class</span>.<span class="variable">prototype</span>.<span class="variable">adapt</span> = <span class="keyword">function</span>(<span class="variable">obj</span>, <span class="variable">recursive</span>, <span class="variable">func</span>){    	
    	<span class="keyword">var</span> <span class="variable">adaptAtoB</span> = <span class="keyword">function</span>(<span class="variable">a</span>, <span class="variable">b</span>, <span class="variable">recursive</span>, <span class="variable">func</span>){
    		<span class="keyword">for</span> ( <span class="keyword">var</span> <span class="variable">name</span> <span class="keyword">in</span> <span class="variable">a</span>){
    			<span class="keyword">if</span>(<span class="variable">recursive</span> === <span class="variable">true</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">a</span>[<span class="variable">name</span>] <span class="variable">instanceof</span> <span class="class">Array</span>){
    				<span class="variable">b</span>[<span class="variable">name</span>] = [];
    				<span class="keyword">for</span>(<span class="keyword">var</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="variable">a</span>[<span class="variable">name</span>]){
    					<span class="variable">b</span>[<span class="variable">name</span>].<span class="variable">push</span>(<span class="variable">a</span>[<span class="variable">name</span>][<span class="variable">i</span>]);
    					<span class="variable">adaptAtoB</span>(<span class="variable">b</span>[<span class="variable">name</span>][<span class="variable">i</span>], <span class="variable">a</span>[<span class="variable">name</span>][<span class="variable">i</span>], <span class="variable">recursive</span>, <span class="variable">func</span>);
    				}
    			}<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">recursive</span> === <span class="variable">true</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="keyword">typeof</span> <span class="variable">a</span>[<span class="variable">name</span>] === <span class="string">'object'</span>){ 
        			<span class="variable">b</span>[<span class="variable">name</span>]={};
        			<span class="variable">adaptAtoB</span>(<span class="variable">a</span>[<span class="variable">name</span>], <span class="variable">b</span>[<span class="variable">name</span>], <span class="variable">recursive</span>, <span class="variable">func</span>);
        		}<span class="keyword">else</span> <span class="keyword">if</span>( <span class="variable">func</span> === <span class="variable">true</span> || <span class="keyword">typeof</span> <span class="variable">a</span>[<span class="variable">name</span>] !== <span class="string">'function'</span> ){
        			<span class="variable">b</span>[<span class="variable">name</span>] = <span class="variable">a</span>[<span class="variable">name</span>];
        		}      		
        	}
    	};
    	
    	<span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="variable">obj</span> === <span class="string">'object'</span>){
    		<span class="variable">adaptAtoB</span>(<span class="variable">obj</span>, <span class="this">this</span>, <span class="variable">recursive</span>, <span class="variable">func</span>);
    	}    	    	
    };
    
    <span class="keyword">return</span> <span class="class">Class</span>;
  };

  <span class="keyword">return</span> <span class="class">Class</span>;
});</code></pre>
</td>
</tr><tr class="filename"><td><h2 id="Entity.js"><a href="#">Entity</a></h2></td><td>Entity.js</td></tr><tr class="code">
<td class="docs">
<p>define(['jo', 'Object', 'Behaviour'], function(jo, Object, Behaviour){
</p>

<pre><code>jo.Entity = Object.extend({</code></pre>

<p>
		joObject: 'Entity',
		init: function(){
			this.<em>super.apply(this, arguments);
		},
		applyB: function(name, args){
			for(var i in this.b){
				if(this.b[i].isBehaviour){
					this.b[i][name].apply(this.b[i], args);
				}
			}
		},
		update: function(time){
			this.applyB('update', [time]);
			this.</em>super(time);
			this.applyB('postUpdate', [time]);
		},
		draw: function(opt, pos, srf){
			this.applyB('draw', [opt, pos, srf]);
			this.<em>super(time);
			this.applyB('postDraw', [opt, pos, srf]);
		},
		addBehaviour: function(name, b){
			this.b[name] = b;
			b.setup(this);
		},
		hasBehaviour: function(name){
			return typeof this.b[name] !== 'undefined';
		},
		removeBehaviour: function(name){
			if(this.hasBehaviour(name)){
				delete this.b[name];
				this.b[name]= undefined;
			}
		},
		</em>postParse: function(){
			this._super();
			this.applyB(setup, [this]);
		}
	});
	jo.Entity;
});</p>
</td>
<td class="code">

</td>
</tr><tr class="filename"><td><h2 id="Game.js"><a href="#">Game</a></h2></td><td>Game.js</td></tr><tr class="code">
<td class="docs">
<p>define(['./jo', './Object', './Screen', './input', './Loader'], function(jo, Object, Screen, input, Loader){</p>

<pre><code>jo.Game = jo.Object.extend({		
	init: function(options){
		this._super(options);

		jo.screen = new jo.Screen(options);
		input.setup();
		input.reserved = [	input.MOUSE1,
							input.MOUSE2,
							input.UP,
							input.DOWN,
							input.LEFT,
							input.RIGHT];
		jo.files = new jo.Loader();
		this.freeze = false;
		jo.game = this;
	},
	loading: function(){
		jo.screen.clear();		
		jo.screen.rect({fill: jo.color(33,33,33)} ,
					{x: jo.screen.width/4-10, y: jo.screen.height/2 -30},
					jo.screen.width/2+20, 60 );
		jo.screen.rect({fill: jo.color(200,200,200)},
					{x: jo.screen.width/4, y: jo.screen.height/2 -20},
					jo.mapto(jo.files.progress, 0, 1, 0, jo.screen.width/2), 40 );

		jo.screen.text({align: 'center', fill: jo.clr.black, stroke: 0},
			       new jo.Point(jo.screen.width/2, jo.screen.height/2), 'Loading...');

		if(jo.files.progress &gt;= 1){
			jo.screen.draw(jo.bind(this.loop, this));
			this._ready();
		}			
	},
	setup: function(fn){
		this._setup = fn;
		return fn();
	},
	load: function(files, folder){
		jo.files.load(files, folder);
		jo.screen.draw(jo.bind(this.loading, this));
	},
	ready: function(fn){
		this._ready = fn;
	},
	loop: function(){
		this.update(jo.screen.ticks);
		this.draw();
	},
	update: function(t){
		if(!this.freeze){
			this._super(t);
		}
		jo.input.update();
		this._update(t);
	},
	draw: function(){
		this._draw();
		this._super({}, jo.pzero, jo.screen);
	},
	OnUpdate: function(fn){
		this._update = fn;
	},
	OnDraw: function(fn){
		this._draw = fn;
	}
});
return jo.Game;</code></pre>

<p>});</p>
</td>
<td class="code">

</td>
</tr><tr class="filename"><td><h2 id="Grid.js"><a href="#">Grid</a></h2></td><td>Grid.js</td></tr><tr class="code">
<td class="docs">
<p>Grid holds arbitrary data in a 2d grid
and delivers methods of manipulation
 </p>
</td>
<td class="code">
<pre><code><span class="variable">define</span>([ <span class="string">'./jo'</span>, <span class="string">'./Object'</span>], <span class="keyword">function</span>(<span class="variable">jo</span>, <span class="class">Object</span>) {

	<span class="variable">jo</span>.<span class="class">Grid</span> = <span class="variable">jo</span>.<span class="class">Object</span>.<span class="variable">extend</span>({</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * 
	 * @param opt
	 * 	width and height needed
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">init</span> : <span class="keyword">function</span>(<span class="variable">opt</span>) {
			<span class="this">this</span>.<span class="variable">_super</span>(<span class="variable">opt</span>);
			<span class="this">this</span>.<span class="variable">width</span> = <span class="variable">opt</span>.<span class="variable">width</span> || <span class="number integer">16</span>;
			<span class="this">this</span>.<span class="variable">height</span> = <span class="variable">opt</span>.<span class="variable">height</span> ||<span class="number integer">16</span>;
			<span class="this">this</span>.<span class="variable">data</span> = [];
			<span class="keyword">for</span>( <span class="keyword">var</span> <span class="variable">i</span> = <span class="number integer">0</span>; <span class="variable">i</span> &<span class="variable">lt</span>; <span class="this">this</span>.<span class="variable">width</span> * <span class="this">this</span>.<span class="variable">height</span>; <span class="variable">i</span>++) {
				<span class="this">this</span>.<span class="variable">data</span>.<span class="variable">push</span>(<span class="number integer">0</span>);
			}
		},
		<span class="variable">_clearTo</span> : <span class="keyword">function</span>(<span class="variable">value</span>) {
			<span class="keyword">for</span> ( <span class="keyword">var</span> <span class="variable">i</span> = <span class="number integer">0</span>; <span class="variable">i</span> &<span class="variable">lt</span>; <span class="this">this</span>.<span class="variable">width</span> * <span class="this">this</span>.<span class="variable">height</span>; <span class="variable">i</span>++) {
				<span class="this">this</span>.<span class="variable">data</span>[<span class="variable">i</span>] = <span class="variable">value</span>;
			}
		},
		<span class="variable">_blit</span> : <span class="keyword">function</span>(<span class="variable">grid</span>, <span class="variable">x</span>, <span class="variable">y</span>, <span class="variable">width</span>, <span class="variable">height</span>) {
			<span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable">width</span> === <span class="string">'undefined'</span>) {
				<span class="keyword">var</span> <span class="variable">width</span> = <span class="variable">grid</span>.<span class="variable">width</span>;
			}
			<span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable">height</span> === <span class="string">'undefined'</span>) {
				<span class="keyword">var</span> <span class="variable">height</span> = <span class="variable">grid</span>.<span class="variable">height</span>;
			}

			<span class="variable">width</span> = <span class="class">Math</span>.<span class="variable">min</span>(<span class="variable">width</span>, <span class="this">this</span>.<span class="variable">width</span> - <span class="variable">x</span>);
			<span class="variable">height</span> = <span class="class">Math</span>.<span class="variable">min</span>(<span class="variable">height</span>, <span class="this">this</span>.<span class="variable">height</span> - <span class="variable">y</span>);
			<span class="keyword">for</span> (<span class="keyword">var</span> <span class="variable">i</span> = <span class="number integer">0</span>; <span class="variable">i</span> &<span class="variable">lt</span>; <span class="variable">height</span>; <span class="variable">i</span>++) {
				<span class="keyword">for</span> (<span class="keyword">var</span> <span class="variable">j</span> = <span class="number integer">0</span>; <span class="variable">j</span> &<span class="variable">lt</span>; <span class="variable">width</span>; <span class="variable">j</span>++) {
					<span class="this">this</span>.<span class="variable">_put</span>(<span class="variable">x</span>+<span class="variable">j</span>, <span class="variable">y</span>+<span class="variable">i</span>, <span class="variable">grid</span>.<span class="variable">get</span>(<span class="variable">j</span>,<span class="variable">i</span>));
				}
			}
		},
		<span class="variable">get</span> : <span class="keyword">function</span>(<span class="variable">x</span>, <span class="variable">y</span>) {
			<span class="keyword">if</span> (<span class="variable">x</span> &<span class="variable">gt</span>;= <span class="number integer">0</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">x</span> &<span class="variable">lt</span>; <span class="this">this</span>.<span class="variable">width</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">y</span> &<span class="variable">gt</span>;= <span class="number integer">0</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">y</span> &<span class="variable">lt</span>; <span class="this">this</span>.<span class="variable">height</span>) {
				<span class="keyword">return</span> <span class="this">this</span>.<span class="variable">data</span>[<span class="variable">x</span> + <span class="variable">y</span> * <span class="this">this</span>.<span class="variable">width</span>];
			}
			<span class="variable">jo</span>.<span class="variable">log</span>(<span class="string">'grid.get out of bounds: '</span> + <span class="variable">x</span> + <span class="string">' | '</span> + <span class="variable">y</span>);
		},
		
		<span class="variable">_put</span> : <span class="keyword">function</span>(<span class="variable">x</span>, <span class="variable">y</span>, <span class="variable">value</span>) {
			<span class="keyword">if</span>(<span class="variable">x</span> &<span class="variable">gt</span>;= <span class="number integer">0</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">x</span> &<span class="variable">lt</span>; <span class="this">this</span>.<span class="variable">width</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">y</span> &<span class="variable">gt</span>;= <span class="number integer">0</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">y</span> &<span class="variable">lt</span>; <span class="this">this</span>.<span class="variable">height</span>){
				<span class="this">this</span>.<span class="variable">data</span>[<span class="variable">y</span> * <span class="this">this</span>.<span class="variable">width</span> + <span class="variable">x</span>] = <span class="variable">value</span>;
			}			
		},
		<span class="variable">put</span> : <span class="keyword">function</span>(<span class="variable">x</span>, <span class="variable">y</span>, <span class="variable">value</span>) {
			<span class="this">this</span>.<span class="variable">_put</span>(<span class="variable">x</span>, <span class="variable">y</span>, <span class="variable">value</span>);
		},
		<span class="variable">_copy</span>: <span class="keyword">function</span>(<span class="variable">frame</span>){
			<span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="variable">frame</span> === <span class="string">'undefined'</span>){
				<span class="variable">frame</span>= {};
			}
			<span class="variable">frame</span>.<span class="variable">x</span> = <span class="variable">frame</span>.<span class="variable">x</span> || <span class="number integer">0</span>;
			<span class="variable">frame</span>.<span class="variable">y</span> = <span class="variable">frame</span>.<span class="variable">y</span> || <span class="number integer">0</span>;
			<span class="variable">frame</span>.<span class="variable">width</span> = <span class="variable">frame</span>.<span class="variable">width</span> || <span class="this">this</span>.<span class="variable">width</span>;
			<span class="variable">frame</span>.<span class="variable">height</span> = <span class="variable">frame</span>.<span class="variable">height</span> || <span class="this">this</span>.<span class="variable">height</span>;
			
			<span class="variable">frame</span>.<span class="variable">x</span> = <span class="class">Math</span>.<span class="variable">max</span>(<span class="number integer">0</span>,<span class="variable">frame</span>.<span class="variable">x</span>);
			<span class="variable">frame</span>.<span class="variable">y</span> = <span class="class">Math</span>.<span class="variable">max</span>(<span class="number integer">0</span>,<span class="variable">frame</span>.<span class="variable">y</span>);
			<span class="variable">frame</span>.<span class="variable">width</span> = <span class="class">Math</span>.<span class="variable">max</span>(<span class="this">this</span>.<span class="variable">width</span>,<span class="variable">frame</span>.<span class="variable">width</span>);
			<span class="variable">frame</span>.<span class="variable">height</span> = <span class="class">Math</span>.<span class="variable">max</span>(<span class="this">this</span>.<span class="variable">height</span>,<span class="variable">frame</span>.<span class="variable">height</span>);
			
			<span class="variable">copy</span> = <span class="keyword">new</span> <span class="variable">jo</span>.<span class="class">Grid</span>(<span class="variable">frame</span>.<span class="variable">width</span>, <span class="variable">frame</span>.<span class="variable">height</span>);
			
			<span class="keyword">for</span>(<span class="keyword">var</span> <span class="variable">i</span> = <span class="number integer">0</span>; <span class="variable">i</span>&<span class="variable">lt</span>; <span class="variable">frame</span>.<span class="variable">height</span>; <span class="variable">i</span>++){
				<span class="keyword">for</span>(<span class="keyword">var</span> <span class="variable">j</span> = <span class="number integer">0</span>; <span class="variable">j</span>&<span class="variable">lt</span>; <span class="variable">frame</span>.<span class="variable">width</span>; <span class="variable">j</span>++){
					<span class="variable">copy</span>.<span class="variable">put</span>(<span class="variable">j</span>,<span class="variable">i</span>,<span class="this">this</span>.<span class="variable">get</span>(<span class="variable">frame</span>.<span class="variable">x</span> + <span class="variable">j</span>, <span class="variable">frame</span>.<span class="variable">y</span> + <span class="variable">i</span>));
				}
			}
			<span class="keyword">return</span> <span class="variable">copy</span>;
		},
		<span class="variable">shift</span>: <span class="keyword">function</span>(<span class="variable">x</span>, <span class="variable">y</span>, <span class="variable">clear</span>){
			<span class="keyword">var</span> <span class="variable">copy</span> = <span class="this">this</span>.<span class="variable">_copy</span>();
			<span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="variable">clear</span> !== <span class="string">'undefined'</span>){
				<span class="this">this</span>.<span class="variable">_clearTo</span>(<span class="variable">clear</span>);
			}
			<span class="this">this</span>.<span class="variable">_blit</span>(<span class="variable">copy</span>,<span class="variable">x</span>,<span class="variable">y</span>);
		}, 
		<span class="variable">resize</span>: <span class="keyword">function</span>(<span class="variable">width</span>, <span class="variable">height</span>, <span class="variable">clear</span>){
			<span class="keyword">var</span> <span class="variable">copy</span> = <span class="this">this</span>.<span class="variable">_copy</span>();
			<span class="this">this</span>.<span class="variable">width</span>= <span class="variable">width</span>;
			<span class="this">this</span>.<span class="variable">height</span> = <span class="variable">height</span>;
			<span class="this">this</span>.<span class="variable">data</span>=[];
			<span class="keyword">for</span>( <span class="keyword">var</span> <span class="variable">i</span> = <span class="number integer">0</span>; <span class="variable">i</span> &<span class="variable">lt</span>; <span class="this">this</span>.<span class="variable">width</span> * <span class="this">this</span>.<span class="variable">height</span>; <span class="variable">i</span>++) {
				<span class="this">this</span>.<span class="variable">data</span>.<span class="variable">push</span>(<span class="number integer">0</span>);
			}
			<span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="variable">clear</span> !== <span class="string">'undefined'</span>){
				<span class="this">this</span>.<span class="variable">_clearTo</span>(<span class="variable">clear</span>);
			}
			<span class="this">this</span>.<span class="variable">_blit</span>(<span class="variable">copy</span>,<span class="number integer">0</span>,<span class="number integer">0</span>);
		}
	});
	<span class="keyword">return</span> <span class="variable">jo</span>.<span class="class">Grid</span>;
});</code></pre>
</td>
</tr><tr class="filename"><td><h2 id="Loader.js"><a href="#">Loader</a></h2></td><td>Loader.js</td></tr><tr class="code">
<td class="docs">
<p>define([ './jo', './Sprite' ], function(jo, Sprite) {</p>
</td>
<td class="code">
<pre><code>*
	 * @<span class="keyword">class</span> <span class="variable">loads</span> <span class="variable">and</span> <span class="variable">stores</span> <span class="variable">your</span> <span class="variable">game</span> <span class="variable">assets</span> <span class="variable">specify</span> <span class="variable">them</span> <span class="keyword">in</span> <span class="variable">files</span>[] <span class="variable">and</span>
	 * <span class="variable">then</span> <span class="variable">call</span> <span class="variable">load</span> <span class="variable">to</span> <span class="variable">load</span> <span class="variable">them</span>, <span class="variable">you</span> <span class="variable">can</span> <span class="variable">also</span> <span class="variable">call</span> <span class="variable">loadImg</span>, <span class="variable">loadSfx</span> <span class="variable">or</span> <span class="variable">loadMusic</span>
	 * <span class="variable">to</span> <span class="variable">load</span> <span class="variable">individual</span> <span class="variable">files</span>
	 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>jo.Loader = jo.Class.extend(</p>
</td>
<td class="code">
<pre><code>*
		 * @<span class="variable">lends</span> <span class="variable">jo</span>.<span class="class">Loader</span>.<span class="variable">prototype</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>{
		files : [],
		folder : '',
		img : {},
		sfx : {},
		music : {},
		progress : 0,
		fileCount: 0,
		loaded : 0,
		audioExt : '.ogg',</p>
</td>
<td class="code">
<pre><code>*
		 * @<span class="variable">constructs</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>init: function(){
			this.testAudio();
		},</p>
</td>
<td class="code">
<pre><code>*
		 * 	<span class="variable">load</span> <span class="variable">images</span>, <span class="variable">sounds</span> <span class="variable">and</span> <span class="variable">music</span>, <span class="variable">specifying</span> <span class="variable">a</span> <span class="variable">folder</span> <span class="variable">to</span> <span class="variable">load</span> <span class="variable">from</span> <span class="variable">is</span> <span class="variable">optional</span>
		 * @<span class="variable">param</span> <span class="variable">files</span>
		 * @<span class="variable">param</span> <span class="variable">folder</span>=
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>load : function(files, folder) {
			if (typeof (files) !== 'undefined') {
				this.files = files;
			}
			if (typeof (folder) !== 'undefined') {
				this.folder = folder;
			}	
			for ( var i = 0; i &lt; this.files.length; i++) {
				var src = this.files[i];
				var type = src.substring(0, src.indexOf('/'));
				if(typeof (folder) !== 'undefined'){
					src = this.folder + '/' + src;
				}				
				if (type === 'sfx') {
					this.loadSfx(src);
				} else if (type === 'music') {
					src = src.substring(0, src.lastIndexOf('.'));
					src += this.audioExt;
					this.loadMusic(src);
				} else {
					this.loadImg(src);
				}
			}
		},</p>
</td>
<td class="code">
<pre><code>*
		 * <span class="variable">tests</span> <span class="variable">the</span> <span class="variable">browser</span> <span class="variable">audio</span> <span class="variable">support</span>, <span class="keyword">for</span> <span class="variable">filename</span> <span class="variable">extensions</span>
		 * @<span class="variable">private</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>testAudio : function() {
			try {
				this.audioObj = new Audio('');
				this.audioObjSupport = !!(this.audioObj.canPlayType);
				this.basicAudioSupport = !!(!this.audioObjSupport ? this.audioObj.play: false);</p>

<pre><code>			if (this.audioObj.canPlayType) {
				// Currently canPlayType(type) returns: 'no',
				// 'maybe' or 'probably'
				this.ogg = ('no' != this.audioObj.canPlayType('audio/ogg')) &amp;&amp; ('' != this.audioObj.canPlayType('audio/ogg'));
				this.mp3 = ('no' != this.audioObj.canPlayType('audio/mpeg')) &amp;&amp; ('' != this.audioObj.canPlayType('audio/mpeg'));
			}
		} catch (e) {
			this.audioObjSupport = false;
			this.basicAudioSupport = false;
		}
		if (this.ogg) {
			this.audioExt = '.ogg';
		} else if (this.mp3) {
			this.audioExt = '.mp3';
		} else {
			this.audioExt = '.wav';
		}
	},</code></pre>
</td>
<td class="code">
<pre><code>*
		 * <span class="variable">loads</span> <span class="variable">and</span> <span class="variable">image</span>
		 * @<span class="variable">param</span> <span class="variable">src</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>loadImg : function(src) {
			this.fileCount += 1;	
			var name = src.substring(src.lastIndexOf('/') + 1, src.lastIndexOf('.'));
			this.img[name] = new Sprite(src, jo.bind(this.onLoad, this));
			this.img[name].name = name;
		},</p>
</td>
<td class="code">
<pre><code>*
		 * <span class="variable">loads</span> <span class="variable">a</span> .<span class="variable">wav</span> <span class="variable">sound</span> <span class="variable">file</span>
		 * @<span class="variable">param</span> <span class="variable">src</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>loadSfx : function(src) {
			if(this.audioObjSupport){
				this.fileCount += 1;						
				var name = src.substring(src.lastIndexOf('/') + 1, src.lastIndexOf('.'));
				this.sfx[name] = new Audio(src);
				this.sfx[name].load();
				this.sfx[name].name = name;
				this.sfx[name].addEventListener('canplaythrough', jo.bind(this.onLoad, this), true);</p>

<pre><code>			this.sfx[name].volume=0.8;
			this.sfx[name].looping = function(loop) {
				if (loop) {
					this.addEventListener('ended', function() {
						this.currentTime = 0;
					}, false);
				} else {
					this.addEventListener('ended', function() {
					}, false);
				}
			};
			this.sfx.setVolume=function(v){
				for(i in this){
					if(typeof this[i].volume !== 'undefined'){
						this[i].volume =v;
					}
				}
			};
			this.sfx.mute= function(){
				this.setVolume(0);

			};
			this.sfx.unMute= function(){
				this.setVolume(0.8);
			};

		}
	},</code></pre>
</td>
<td class="code">
<pre><code>*
		 * <span class="variable">loads</span> <span class="variable">an</span> .<span class="variable">mp3</span> <span class="variable">or</span> .<span class="variable">ogg</span> <span class="variable">file</span> <span class="variable">depending</span> <span class="variable">on</span> <span class="variable">the</span> <span class="variable">browser</span>
		 * @<span class="variable">param</span> <span class="variable">src</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>loadMusic : function(src) {
			if(this.audioObjSupport){
				this.fileCount += 1;	
				var name = src.substring(src.lastIndexOf('/') + 1, src.lastIndexOf('.'));
				this.music[name] = new Audio(src);
				this.music[name].load();
				this.music[name].name = name;
				this.music[name].loop = true;
				this.music[name].addEventListener('canplaythrough',	jo.bind(this.onLoad, this), true);</p>

<pre><code>			this.music[name].looping = function(loop) {
				if (loop) {
					this.addEventListener('ended', function() {
						this.currentTime = 0;
					}, false);
				} else {
					this.addEventListener('ended', function() {
					}, false);
				}
			};
			this.music[name].stop = function() {
				this.pause();
				this.currentTime = 0;
			};
			this.music[name].volume = 0.3;
			this.music[name].looping(true);
			this.music.setVolume=function(v){
				for(i in this){
					if(typeof this[i].volume !== 'undefined'){
						this[i].volume =v;
					}
				}
			};
			this.music.mute= function(){
				this.setVolume(0);
			};
			this.music.unMute= function(){
				this.setVolume(0.3);
			};
		}
	},</code></pre>
</td>
<td class="code">
<pre><code>*
		 * <span class="variable">callback</span> <span class="keyword">for</span> <span class="variable">the</span> <span class="variable">loading</span> <span class="variable">bar</span>
		 * @<span class="variable">private</span>
		 * @<span class="variable">param</span> <span class="variable">event</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>onLoad : function(event) {
			this.loaded += 1;
			if(this.loaded &lt;= this.fileCount){
				this.progress = jo.mapto(this.loaded, 0, this.fileCount, 0, 1);
				jo.log(event.target.name + ' ..loaded  ' + this.loaded + ' / ' + this.fileCount);
			}</p>

<pre><code>	},

	mute: function(){
		this.music.setVolume(0);
		this.sfx.setVolume(0);
	},
	unMute: function(){
		this.music.setVolume(0.3);
		this.sfx.setVolume(0.8);
	}
});
return jo.Loader;</code></pre>

<p>});</p>
</td>
<td class="code">

</td>
</tr><tr class="filename"><td><h2 id="Mersenne.js"><a href="#">Mersenne</a></h2></td><td>Mersenne.js</td></tr><tr class="code">
<td class="docs">
<p>define([], function(){</p>

<pre><code>// this program is a JavaScript version of Mersenne Twister,
// a straight conversion from the original program, mt19937ar.c,
// translated by y. okada on july 17, 2006.
// and modified a little at july 20, 2006, but there are not any substantial differences.
// converted to a JavaScript Class and put inside a closure on april 8, 2011 by Moritz Laass
// in this program, procedure descriptions and comments of original source code were not removed.
// lines commented with //c// were originally descriptions of c procedure. and a few following lines are appropriate JavaScript descriptions.
// lines commented with</code></pre>
</td>
<td class="code">
<pre><code> <span class="variable">and</span> </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>are original comments.
	// lines commented with // are additional comments in this JavaScript version.</p>
</td>
<td class="code">
<pre><code>
	   <span class="class">A</span> <span class="class">C</span>-<span class="variable">program</span> <span class="keyword">for</span> <span class="class">MT19937</span>, <span class="keyword">with</span> <span class="variable">initialization</span> <span class="variable">improved</span> <span class="regexp">/1/</span><span class="number integer">26</span>.
	   <span class="class">Coded</span> <span class="variable">by</span> <span class="class">Takuji</span> <span class="class">Nishimura</span> <span class="variable">and</span> <span class="class">Makoto</span> <span class="class">Matsumoto</span>.

	   <span class="class">Before</span> <span class="variable">using</span>, <span class="variable">initialize</span> <span class="variable">the</span> <span class="variable">state</span> <span class="variable">by</span> <span class="variable">using</span> <span class="variable">init_genrand</span>(<span class="variable">seed</span>)
	   <span class="variable">or</span> <span class="variable">init_by_array</span>(<span class="variable">init_key</span>, <span class="variable">key_length</span>).

	   <span class="class">Copyright</span> (<span class="class">C</span>) <span class="number integer">1997</span> - <span class="number integer">2002</span>, <span class="class">Makoto</span> <span class="class">Matsumoto</span> <span class="variable">and</span> <span class="class">Takuji</span> <span class="class">Nishimura</span>,
	   <span class="class">All</span> <span class="variable">rights</span> <span class="variable">reserved</span>.

	   <span class="class">Redistribution</span> <span class="variable">and</span> <span class="variable">use</span> <span class="keyword">in</span> <span class="variable">source</span> <span class="variable">and</span> <span class="variable">binary</span> <span class="variable">forms</span>, <span class="keyword">with</span> <span class="variable">or</span> <span class="variable">without</span>
	   <span class="variable">modification</span>, <span class="variable">are</span> <span class="variable">permitted</span> <span class="variable">provided</span> <span class="variable">that</span> <span class="variable">the</span> <span class="variable">following</span> <span class="variable">conditions</span>
	   <span class="variable">are</span> <span class="variable">met</span>:

	     <span class="number integer">1</span>. <span class="class">Redistributions</span> <span class="variable">of</span> <span class="variable">source</span> <span class="variable">code</span> <span class="variable">must</span> <span class="variable">retain</span> <span class="variable">the</span> <span class="variable">above</span> <span class="variable">copyright</span>
	        <span class="variable">notice</span>, <span class="this">this</span> <span class="variable">list</span> <span class="variable">of</span> <span class="variable">conditions</span> <span class="variable">and</span> <span class="variable">the</span> <span class="variable">following</span> <span class="variable">disclaimer</span>.

	     <span class="number integer">2</span>. <span class="class">Redistributions</span> <span class="keyword">in</span> <span class="variable">binary</span> <span class="variable">form</span> <span class="variable">must</span> <span class="variable">reproduce</span> <span class="variable">the</span> <span class="variable">above</span> <span class="variable">copyright</span>
	        <span class="variable">notice</span>, <span class="this">this</span> <span class="variable">list</span> <span class="variable">of</span> <span class="variable">conditions</span> <span class="variable">and</span> <span class="variable">the</span> <span class="variable">following</span> <span class="variable">disclaimer</span> <span class="keyword">in</span> <span class="variable">the</span>
	        <span class="variable">documentation</span> <span class="variable">and</span>/<span class="variable">or</span> <span class="variable">other</span> <span class="variable">materials</span> <span class="variable">provided</span> <span class="keyword">with</span> <span class="variable">the</span> <span class="variable">distribution</span>.

	     <span class="number integer">3</span>. <span class="class">The</span> <span class="variable">names</span> <span class="variable">of</span> <span class="variable">its</span> <span class="variable">contributors</span> <span class="variable">may</span> <span class="variable">not</span> <span class="variable">be</span> <span class="variable">used</span> <span class="variable">to</span> <span class="variable">endorse</span> <span class="variable">or</span> <span class="variable">promote</span>
	        <span class="variable">products</span> <span class="variable">derived</span> <span class="variable">from</span> <span class="this">this</span> <span class="variable">software</span> <span class="variable">without</span> <span class="variable">specific</span> <span class="variable">prior</span> <span class="variable">written</span>
	        <span class="variable">permission</span>.

	   <span class="class">THIS</span> <span class="class">SOFTWARE</span> <span class="class">IS</span> <span class="class">PROVIDED</span> <span class="class">BY</span> <span class="class">THE</span> <span class="class">COPYRIGHT</span> <span class="class">HOLDERS</span> <span class="class">AND</span> <span class="class">CONTRIBUTORS</span>
	   &<span class="variable">quot</span>;<span class="class">AS</span> <span class="class">IS</span>&<span class="variable">quot</span>; <span class="class">AND</span> <span class="class">ANY</span> <span class="class">EXPRESS</span> <span class="class">OR</span> <span class="class">IMPLIED</span> <span class="class">WARRANTIES</span>, <span class="class">INCLUDING</span>, <span class="class">BUT</span> <span class="class">NOT</span>
	   <span class="class">LIMITED</span> <span class="class">TO</span>, <span class="class">THE</span> <span class="class">IMPLIED</span> <span class="class">WARRANTIES</span> <span class="class">OF</span> <span class="class">MERCHANTABILITY</span> <span class="class">AND</span> <span class="class">FITNESS</span> <span class="class">FOR</span>
	   <span class="class">A</span> <span class="class">PARTICULAR</span> <span class="class">PURPOSE</span> <span class="class">ARE</span> <span class="class">DISCLAIMED</span>.  <span class="class">IN</span> <span class="class">NO</span> <span class="class">EVENT</span> <span class="class">SHALL</span> <span class="class">THE</span> <span class="class">COPYRIGHT</span> <span class="class">OWNER</span> <span class="class">OR</span>
	   <span class="class">CONTRIBUTORS</span> <span class="class">BE</span> <span class="class">LIABLE</span> <span class="class">FOR</span> <span class="class">ANY</span> <span class="class">DIRECT</span>, <span class="class">INDIRECT</span>, <span class="class">INCIDENTAL</span>, <span class="class">SPECIAL</span>,
	   <span class="class">EXEMPLARY</span>, <span class="class">OR</span> <span class="class">CONSEQUENTIAL</span> <span class="class">DAMAGES</span> (<span class="class">INCLUDING</span>, <span class="class">BUT</span> <span class="class">NOT</span> <span class="class">LIMITED</span> <span class="class">TO</span>,
	   <span class="class">PROCUREMENT</span> <span class="class">OF</span> <span class="class">SUBSTITUTE</span> <span class="class">GOODS</span> <span class="class">OR</span> <span class="class">SERVICES</span>; <span class="class">LOSS</span> <span class="class">OF</span> <span class="class">USE</span>, <span class="class">DATA</span>, <span class="class">OR</span>
	   <span class="class">PROFITS</span>; <span class="class">OR</span> <span class="class">BUSINESS</span> <span class="class">INTERRUPTION</span>) <span class="class">HOWEVER</span> <span class="class">CAUSED</span> <span class="class">AND</span> <span class="class">ON</span> <span class="class">ANY</span> <span class="class">THEORY</span> <span class="class">OF</span>
	   <span class="class">LIABILITY</span>, <span class="class">WHETHER</span> <span class="class">IN</span> <span class="class">CONTRACT</span>, <span class="class">STRICT</span> <span class="class">LIABILITY</span>, <span class="class">OR</span> <span class="class">TORT</span> (<span class="class">INCLUDING</span>
	   <span class="class">NEGLIGENCE</span> <span class="class">OR</span> <span class="class">OTHERWISE</span>) <span class="class">ARISING</span> <span class="class">IN</span> <span class="class">ANY</span> <span class="class">WAY</span> <span class="class">OUT</span> <span class="class">OF</span> <span class="class">THE</span> <span class="class">USE</span> <span class="class">OF</span> <span class="class">THIS</span>
	   <span class="class">SOFTWARE</span>, <span class="class">EVEN</span> <span class="class">IF</span> <span class="class">ADVISED</span> <span class="class">OF</span> <span class="class">THE</span> <span class="class">POSSIBILITY</span> <span class="class">OF</span> <span class="class">SUCH</span> <span class="class">DAMAGE</span>.


	   <span class="class">Any</span> <span class="variable">feedback</span> <span class="variable">is</span> <span class="variable">very</span> <span class="variable">welcome</span>.
	   <span class="variable">http</span>:<span class="comment">//www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/emt.html</span>
	   <span class="variable">email</span>: <span class="variable">m</span>-<span class="variable">mat</span> @ <span class="variable">math</span>.<span class="variable">sci</span>.<span class="variable">hiroshima</span>-<span class="variable">u</span>.<span class="variable">ac</span>.<span class="variable">jp</span> (<span class="variable">remove</span> <span class="variable">space</span>)
	</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>var Mersenne = (function (){</p>
</td>
<td class="code">
<pre><code> <span class="class">Period</span> <span class="variable">parameters</span> </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>//c//#define N 624
		//c//#define M 397
		//c//#define MATRIX_A 0x9908b0dfUL</p>
</td>
<td class="code">
<pre><code> <span class="variable">constant</span> <span class="variable">vector</span> <span class="variable">a</span> </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>//c//#define UPPER_MASK 0x80000000UL</p>
</td>
<td class="code">
<pre><code> <span class="variable">most</span> <span class="variable">significant</span> <span class="variable">w</span>-<span class="variable">r</span> <span class="variable">bits</span> </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>//c//#define LOWER_MASK 0x7fffffffUL</p>
</td>
<td class="code">
<pre><code> <span class="variable">least</span> <span class="variable">significant</span> <span class="variable">r</span> <span class="variable">bits</span> </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>var N = 624;
		var M = 397;
		var MATRIX_A = 0x9908b0df;</p>
</td>
<td class="code">
<pre><code> <span class="variable">constant</span> <span class="variable">vector</span> <span class="variable">a</span> </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>var UPPER_MASK = 0x80000000;</p>
</td>
<td class="code">
<pre><code> <span class="variable">most</span> <span class="variable">significant</span> <span class="variable">w</span>-<span class="variable">r</span> <span class="variable">bits</span> </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>var LOWER_MASK = 0x7fffffff;</p>
</td>
<td class="code">
<pre><code> <span class="variable">least</span> <span class="variable">significant</span> <span class="variable">r</span> <span class="variable">bits</span> </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>//c//static unsigned long mt[N];</p>
</td>
<td class="code">
<pre><code> <span class="variable">the</span> <span class="variable">array</span> <span class="keyword">for</span> <span class="variable">the</span> <span class="variable">state</span> <span class="variable">vector</span>  </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>//c//static int mti=N+1;</p>
</td>
<td class="code">
<pre><code> <span class="variable">mti</span>==<span class="class">N</span>+<span class="number integer">1</span> <span class="variable">means</span> <span class="variable">mt</span>[<span class="class">N</span>] <span class="variable">is</span> <span class="variable">not</span> <span class="variable">initialized</span> </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>var mt = new Array(N);</p>
</td>
<td class="code">
<pre><code> <span class="variable">the</span> <span class="variable">array</span> <span class="keyword">for</span> <span class="variable">the</span> <span class="variable">state</span> <span class="variable">vector</span>  </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>var mti = N+1;</p>
</td>
<td class="code">
<pre><code> <span class="variable">mti</span>==<span class="class">N</span>+<span class="number integer">1</span> <span class="variable">means</span> <span class="variable">mt</span>[<span class="class">N</span>] <span class="variable">is</span> <span class="variable">not</span> <span class="variable">initialized</span> </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>function unsigned32 (n1) // returns a 32-bits unsiged integer from an operand to which applied a bit operator.
		{
			return n1 &lt; 0 ? (n1 ^ UPPER<em>MASK) + UPPER</em>MASK : n1;
		}</p>

<pre><code>	function subtraction32 (n1, n2) // emulates lowerflow of a c 32-bits unsiged integer variable, instead of the operator -. these both arguments must be non-negative integers expressible using unsigned 32 bits.
	{
		return n1 &lt; n2 ? unsigned32((0x100000000 - (n2 - n1)) &amp; 0xffffffff) : n1 - n2;
	}

	function addition32 (n1, n2) // emulates overflow of a c 32-bits unsiged integer variable, instead of the operator +. these both arguments must be non-negative integers expressible using unsigned 32 bits.
	{
		return unsigned32((n1 + n2) &amp; 0xffffffff);
	}

	function multiplication32 (n1, n2) // emulates overflow of a c 32-bits unsiged integer variable, instead of the operator *. these both arguments must be non-negative integers expressible using unsigned 32 bits.
	{
		var sum = 0;
		for (var i = 0; i &lt; 32; ++i){
			if ((n1 &gt;&gt;&gt; i) &amp; 0x1){
				sum = addition32(sum, unsigned32(n2 &lt;&lt; i));
			}
		}
		return sum;
	}
	var Mersenne = function(){
		this.mt = new Array(N);</code></pre>
</td>
<td class="code">
<pre><code> <span class="variable">the</span> <span class="variable">array</span> <span class="keyword">for</span> <span class="variable">the</span> <span class="variable">state</span> <span class="variable">vector</span>  </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>this.mti = N+1;</p>
</td>
<td class="code">
<pre><code> <span class="variable">mti</span>==<span class="class">N</span>+<span class="number integer">1</span> <span class="variable">means</span> <span class="variable">mt</span>[<span class="class">N</span>] <span class="variable">is</span> <span class="variable">not</span> <span class="variable">initialized</span> </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>};</p>
</td>
<td class="code">
<pre><code> <span class="variable">initializes</span> <span class="variable">mt</span>[<span class="class">N</span>] <span class="keyword">with</span> <span class="variable">a</span> <span class="variable">seed</span> </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>//c//void init<em>genrand(unsigned long s)
		Mersenne.prototype.init</em>genrand = function (s)
		{
			//c//mt[0]= s &amp; 0xffffffff;
			this.mt[0]= unsigned32(s &amp; 0xffffffff);
			for (mti=1; mti&lt;N; mti++) {
				this.mt[this.mti] = 
				//c//(1812433253 * (mt[mti-1] ^ (mt[mti-1] &gt;&gt; 30)) + mti);
				addition32(multiplication32(1812433253, unsigned32(this.mt[this.mti-1] ^ (this.mt[this.mti-1] &gt;&gt;&gt; 30))), mti);</p>
</td>
<td class="code">
<pre><code> <span class="class">See</span> <span class="class">Knuth</span> <span class="class">TAOCP</span> <span class="class">Vol2</span>. <span class="variable">rd</span> <span class="class">Ed</span>. <span class="class">P</span>.<span class="number integer">106</span> <span class="keyword">for</span> <span class="variable">multiplier</span>. </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p> In the previous versions, MSBs of the seed affect   </p>
</td>
<td class="code">

</td>
</tr>
<tr class="code">
<td class="docs">
<p> only MSBs of the array mt[].                        </p>
</td>
<td class="code">

</td>
</tr>
<tr class="code">
<td class="docs">
<p> 2002/01/09 modified by Makoto Matsumoto             </p>
</td>
<td class="code">
<pre><code><span class="comment">//c//mt[mti] &amp;= 0xffffffff;</span>
				<span class="this">this</span>.<span class="variable">mt</span>[<span class="this">this</span>.<span class="variable">mti</span>] = <span class="variable">unsigned32</span>(<span class="this">this</span>.<span class="variable">mt</span>[<span class="this">this</span>.<span class="variable">mti</span>] &<span class="variable">amp</span>; <span class="variable">xffffffff</span>);</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p> for &gt;32 bit machines </p>
</td>
<td class="code">
<pre><code>}
		};</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p> generates a random number on [0,0xffffffff]-interval </p>
</td>
<td class="code">
<pre><code><span class="comment">//c//unsigned long genrand_int32(void)</span>
		<span class="class">Mersenne</span>.<span class="variable">prototype</span>.<span class="variable">genrand_int32</span> = <span class="keyword">function</span> ()
		{
			<span class="comment">//c//unsigned long y;</span>
			<span class="comment">//c//static unsigned long mag01[2]={0x0UL, MATRIX_A};</span>
			<span class="keyword">var</span> <span class="variable">y</span>;
			<span class="keyword">var</span> <span class="variable">mag01</span> = <span class="keyword">new</span> <span class="class">Array</span>(<span class="variable">x0</span>, <span class="class">MATRIX_A</span>);</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p> mag01[x] = x * MATRIX_A  for x=0,1 </p>
</td>
<td class="code">
<pre><code><span class="keyword">if</span> (<span class="this">this</span>.<span class="variable">mti</span> &<span class="variable">gt</span>;= <span class="class">N</span>) {</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p> generate N words at one time </p>
</td>
<td class="code">
<pre><code><span class="comment">//c//int kk;</span>
				<span class="keyword">var</span> <span class="variable">kk</span>;
	
				<span class="keyword">if</span> (<span class="this">this</span>.<span class="variable">mti</span> == <span class="class">N</span>+<span class="number integer">1</span>)</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p> if init_genrand() has not been called, </p>
</td>
<td class="code">
<pre><code><span class="variable">init_genrand</span>(<span class="number integer">5489</span>);</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p> a default initial seed is used </p>
</td>
<td class="code">
<pre><code><span class="keyword">for</span> (<span class="variable">kk</span>=<span class="number integer">0</span>;<span class="variable">kk</span>&<span class="variable">lt</span>;<span class="class">N</span>-<span class="class">M</span>;<span class="variable">kk</span>++) {
					<span class="comment">//c//y = (mt[kk]&amp;UPPER_MASK)|(mt[kk+1]&amp;LOWER_MASK);</span>
					<span class="comment">//c//mt[kk] = mt[kk+M] ^ (y &gt;&gt; 1) ^ mag01[y &amp; 0x1];</span>
					<span class="variable">y</span> = <span class="variable">unsigned32</span>((<span class="this">this</span>.<span class="variable">mt</span>[<span class="variable">kk</span>]&<span class="variable">amp</span>;<span class="class">UPPER_MASK</span>)|(<span class="this">this</span>.<span class="variable">mt</span>[<span class="variable">kk</span>+<span class="number integer">1</span>]&<span class="variable">amp</span>;<span class="class">LOWER_MASK</span>));
					<span class="this">this</span>.<span class="variable">mt</span>[<span class="variable">kk</span>] = <span class="variable">unsigned32</span>(<span class="this">this</span>.<span class="variable">mt</span>[<span class="variable">kk</span>+<span class="class">M</span>] ^ (<span class="variable">y</span> &<span class="variable">gt</span>;&<span class="variable">gt</span>;&<span class="variable">gt</span>; <span class="number integer">1</span>) ^ <span class="variable">mag01</span>[<span class="variable">y</span> &<span class="variable">amp</span>; <span class="variable">x1</span>]);
				}
				<span class="keyword">for</span> (;<span class="variable">kk</span>&<span class="variable">lt</span>;<span class="class">N</span>-<span class="number integer">1</span>;<span class="variable">kk</span>++) {
					<span class="comment">//c//y = (mt[kk]&amp;UPPER_MASK)|(mt[kk+1]&amp;LOWER_MASK);</span>
					<span class="comment">//c//mt[kk] = mt[kk+(M-N)] ^ (y &gt;&gt; 1) ^ mag01[y &amp; 0x1];</span>
					<span class="variable">y</span> = <span class="variable">unsigned32</span>((<span class="this">this</span>.<span class="variable">mt</span>[<span class="variable">kk</span>]&<span class="variable">amp</span>;<span class="class">UPPER_MASK</span>)|(<span class="this">this</span>.<span class="variable">mt</span>[<span class="variable">kk</span>+<span class="number integer">1</span>]&<span class="variable">amp</span>;<span class="class">LOWER_MASK</span>));
					<span class="this">this</span>.<span class="variable">mt</span>[<span class="variable">kk</span>] = <span class="variable">unsigned32</span>(<span class="this">this</span>.<span class="variable">mt</span>[<span class="variable">kk</span>+(<span class="class">M</span>-<span class="class">N</span>)] ^ (<span class="variable">y</span> &<span class="variable">gt</span>;&<span class="variable">gt</span>;&<span class="variable">gt</span>; <span class="number integer">1</span>) ^ <span class="variable">mag01</span>[<span class="variable">y</span> &<span class="variable">amp</span>; <span class="variable">x1</span>]);
				}
				<span class="comment">//c//y = (mt[N-1]&amp;UPPER_MASK)|(mt[0]&amp;LOWER_MASK);</span>
				<span class="comment">//c//mt[N-1] = mt[M-1] ^ (y &gt;&gt; 1) ^ mag01[y &amp; 0x1];</span>
				<span class="variable">y</span> = <span class="variable">unsigned32</span>((<span class="this">this</span>.<span class="variable">mt</span>[<span class="class">N</span>-<span class="number integer">1</span>]&<span class="variable">amp</span>;<span class="class">UPPER_MASK</span>)|(<span class="this">this</span>.<span class="variable">mt</span>[<span class="number integer">0</span>]&<span class="variable">amp</span>;<span class="class">LOWER_MASK</span>));
				<span class="this">this</span>.<span class="variable">mt</span>[<span class="class">N</span>-<span class="number integer">1</span>] = <span class="variable">unsigned32</span>(<span class="this">this</span>.<span class="variable">mt</span>[<span class="class">M</span>-<span class="number integer">1</span>] ^ (<span class="variable">y</span> &<span class="variable">gt</span>;&<span class="variable">gt</span>;&<span class="variable">gt</span>; <span class="number integer">1</span>) ^ <span class="variable">mag01</span>[<span class="variable">y</span> &<span class="variable">amp</span>; <span class="variable">x1</span>]);
				<span class="this">this</span>.<span class="variable">mti</span> = <span class="number integer">0</span>;
			}
	
			<span class="variable">y</span> = <span class="this">this</span>.<span class="variable">mt</span>[<span class="this">this</span>.<span class="variable">mti</span>++];</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p> Tempering </p>
</td>
<td class="code">
<pre><code><span class="comment">//c//y ^= (y &gt;&gt; 11);</span>
			<span class="comment">//c//y ^= (y &lt;&lt; 7) &amp; 0x9d2c5680;</span>
			<span class="comment">//c//y ^= (y &lt;&lt; 15) &amp; 0xefc60000;</span>
			<span class="comment">//c//y ^= (y &gt;&gt; 18);</span>
			<span class="variable">y</span> = <span class="variable">unsigned32</span>(<span class="variable">y</span> ^ (<span class="variable">y</span> &<span class="variable">gt</span>;&<span class="variable">gt</span>;&<span class="variable">gt</span>; <span class="number integer">11</span>));
			<span class="variable">y</span> = <span class="variable">unsigned32</span>(<span class="variable">y</span> ^ ((<span class="variable">y</span> &<span class="variable">lt</span>;&<span class="variable">lt</span>; <span class="number integer">7</span>) &<span class="variable">amp</span>; <span class="variable">x9d2c5680</span>));
			<span class="variable">y</span> = <span class="variable">unsigned32</span>(<span class="variable">y</span> ^ ((<span class="variable">y</span> &<span class="variable">lt</span>;&<span class="variable">lt</span>; <span class="number integer">15</span>) &<span class="variable">amp</span>; <span class="variable">xefc60000</span>));
			<span class="variable">y</span> = <span class="variable">unsigned32</span>(<span class="variable">y</span> ^ (<span class="variable">y</span> &<span class="variable">gt</span>;&<span class="variable">gt</span>;&<span class="variable">gt</span>; <span class="number integer">18</span>));
	
			<span class="keyword">return</span> <span class="variable">y</span>;
		};</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p> generates a random number on [0,1]-real-interval </p>
</td>
<td class="code">
<pre><code><span class="comment">//c//double genrand_real1(void)</span>
		<span class="class">Mersenne</span>.<span class="variable">prototype</span>.<span class="variable">genrand_real1</span>= <span class="keyword">function</span>()
		{
			<span class="keyword">return</span> <span class="this">this</span>.<span class="variable">genrand_int32</span>()*(<span class="number float">1.0</span>/<span class="number float">4294967295.0</span>);</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p> divided by 2^32-1 </p>
</td>
<td class="code">
<pre><code>};</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p> generates a random number on [0,1)-real-interval </p>
</td>
<td class="code">
<pre><code><span class="comment">//c//double genrand_real2(void)</span>
		<span class="class">Mersenne</span>.<span class="variable">prototype</span>.<span class="variable">genrand_real2</span> = <span class="keyword">function</span> ()
		{
			<span class="keyword">return</span> <span class="this">this</span>.<span class="variable">genrand_int32</span>()*(<span class="number float">1.0</span>/<span class="number float">4294967296.0</span>);</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p> divided by 2^32 </p>
</td>
<td class="code">
<pre><code>};</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p> generates a random number on (0,1)-real-interval </p>
</td>
<td class="code">
<pre><code><span class="comment">//c//double genrand_real3(void)</span>
		<span class="class">Mersenne</span>.<span class="variable">prototype</span>.<span class="variable">genrand_real3</span> = <span class="keyword">function</span>()
		{
			<span class="keyword">return</span> ((<span class="this">this</span>.<span class="variable">genrand_int32</span>()) + <span class="number float">0.5</span>)*(<span class="number float">1.0</span>/<span class="number float">4294967296.0</span>);</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p> divided by 2^32 </p>
</td>
<td class="code">
<pre><code>};
	
		<span class="class">Mersenne</span>.<span class="variable">prototype</span>.<span class="variable">seed</span> = <span class="keyword">function</span>(<span class="variable">s</span>){
			<span class="variable">init_genrand</span>(<span class="variable">s</span>);
		};
		<span class="class">Mersenne</span>.<span class="variable">prototype</span>.<span class="variable">get</span> = <span class="keyword">function</span>(<span class="variable">a</span>, <span class="variable">b</span>){
			<span class="keyword">if</span>(<span class="keyword">typeof</span>(<span class="variable">a</span>)===<span class="string">'undefined'</span>){
				<span class="keyword">return</span> <span class="this">this</span>.<span class="variable">genrand_real3</span>();
			}
			<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">typeof</span>(<span class="variable">b</span>)===<span class="string">'undefined'</span>){
				<span class="keyword">return</span> <span class="this">this</span>.<span class="variable">genrand_real3</span>()*<span class="variable">a</span>;
			}<span class="keyword">else</span>{
				<span class="keyword">return</span> <span class="variable">a</span>+ (<span class="this">this</span>.<span class="variable">genrand_real3</span>()*(<span class="variable">b</span>-<span class="variable">a</span>));
			}
		};
		
		<span class="keyword">return</span> <span class="class">Mersenne</span>;
	})();
	
	<span class="keyword">return</span> <span class="class">Mersenne</span>;	
});</code></pre>
</td>
</tr><tr class="filename"><td><h2 id="Object.js"><a href="#">Object</a></h2></td><td>Object.js</td></tr><tr class="code">
<td class="docs">
<p>define(['./jo', './Class' ], function(jo, Class){	
	jo.Object = jo.Class.extend(</p>
</td>
<td class="code">
<pre><code>*
		 * @<span class="variable">lends</span> <span class="variable">jo</span>.<span class="class">Object</span>.<span class="variable">prototype</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>{</p>
</td>
<td class="code">
<pre><code>*
		 * <span class="variable">holds</span> <span class="variable">the</span> <span class="variable">type</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">object</span>, <span class="keyword">for</span> <span class="variable">serialisation</span> <span class="variable">reviving</span> <span class="variable">from</span> <span class="class">JSON</span>
		 * <span class="variable">must</span> <span class="variable">be</span> <span class="variable">the</span> <span class="variable">official</span> <span class="variable">name</span> <span class="variable">without</span> <span class="variable">the</span> <span class="string">'jo.'</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>joObject : 'Object',</p>
</td>
<td class="code">
<pre><code>*
		 * @<span class="variable">constructor</span>
		 * <span class="variable">all</span> <span class="variable">jo</span> <span class="class">Objects</span> <span class="variable">take</span> <span class="variable">just</span> <span class="variable">one</span> <span class="variable">options</span> <span class="variable">argumtn</span> <span class="keyword">with</span> <span class="variable">the</span> <span class="variable">constructor</span> <span class="keyword">for</span> <span class="variable">easy</span> <span class="variable">serialisation</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>init : function(options){
			this.options = options;
			this.obj = {};
			this.joObject = this.joObject;
			this.call={};
		},
		hasCall: function(name){
			return typeof this.call[name] === 'function';
		},</p>
</td>
<td class="code">
<pre><code>*
		 * <span class="variable">adds</span> <span class="variable">a</span> <span class="variable">callback</span> <span class="keyword">with</span> <span class="variable">a</span> <span class="variable">given</span> <span class="variable">name</span>, <span class="variable">overwrites</span> <span class="variable">existing</span> <span class="variable">ones</span> <span class="keyword">with</span> <span class="variable">the</span> <span class="variable">same</span> <span class="variable">name</span>
		 * @<span class="variable">param</span> <span class="variable">name</span>
		 * @<span class="variable">param</span> <span class="variable">fn</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>addCall: function(name, fn){
			if(typeof fn !== 'function'){
				throw 'expecting a function';
			}
			this.call<a href="value.options">name] = fn;
		},
		removeCall: function(name){
			if(typeof this.call[name] !== 'undefined'){
				this.call[name]= undefined;		
			}
		},
		applyCall: function(name, args ){
			if(typeof this.call[name] === 'function'){
				this.call[name].apply(this, args);			
			}
		},
		draw: function(options, position, surface){
			for(var i in this.obj){
				this.obj[i].draw(options, position, surface);
			}
		},
		update: function(time){
			for(var i in this.obj){
				this.obj[i].update(time);
			}
		},
		addObject: function(name, obj){
			if(typeof this.objects[name] === 'undefined'){
				obj._parent = this;
				obj._name = name;
				this.obj[name] = obj;
			}else {
				this.obj[name].addObject(name, obj);
			}
		},
		getObject: function(id){
			return this.obj[id];
		},
		removeObject: function(name){
			delete this.obj[name];
			this.obj[name] = undefined;
		},
		stringify: function(filter){
			return JSON.stringify(this, filter || jo.Object.replacer);
		},
		_postParse: function(){
			for(var i in this.obj){
				this.obj[i]._name = i;
				this.obj[i]._parent=this;
			}
		}
	});
	jo.Object.replacer = function(key, value) {
		if(key === '_parent'){
			value = key;
		}	    
	    return value;
	};
	jo.Object.revive = function(key, value){
		var val = 0;
		if(value &amp;&amp; value.joObject ){
			val = new jo[value.joObject</a>;
			val.adapt(value, true);
			value = val;
			jo.log(val);
			return val;
		}
		if(value){
	    	if(value.isPoint){
	    		return (new jo.Point().copy(value));
	    	}
	    }
		return value;
	};
	jo.Object.parse = function(text){
		var obj = JSON.parse(text, jo.Object.revive);
		obj._postParse();
		return obj;
	};
	return jo.Object;
});</p>
</td>
<td class="code">

</td>
</tr><tr class="filename"><td><h2 id="Point.js"><a href="#">Point</a></h2></td><td>Point.js</td></tr><tr class="code">
<td class="docs">
<ul><li><strong>name</strong>: <em>jo</em>
.Point</li><li><strong>class</strong>: <em>The</em>
Point class defines a simple 2d vector with a set of useful
   functions there are two kinds of arithmetic functions, the first which
   return a new vector are called: sum, dif, mul, div and neg the second
   changes the vector its called on and they are called: add, subtract,
   multiply, divide and negate</li></ul>
</td>
<td class="code">
<pre><code><span class="variable">define</span>([ <span class="string">'./jo'</span>, <span class="string">'./Class'</span> ], <span class="keyword">function</span>(<span class="variable">jo</span>, <span class="class">Class</span>) {

	<span class="variable">jo</span>.<span class="class">Point</span> = <span class="class">Class</span>.<span class="variable">extend</span>({</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @constructor
	 * @methodOf joPoint
	 * @param {Number} x
	 * @param {Number} y
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">init</span> : <span class="keyword">function</span>(<span class="variable">x</span>, <span class="variable">y</span>) {
			<span class="this">this</span>.<span class="variable">x</span> = <span class="variable">x</span>;
			<span class="this">this</span>.<span class="variable">y</span> = <span class="variable">y</span>;
			<span class="this">this</span>.<span class="variable">isPoint</span>=<span class="variable">true</span>;
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @methodOf jo.Point
	 * @description copies another point p
	 * @param p
	 * @returns {this}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">copy</span> : <span class="keyword">function</span>(<span class="variable">p</span>) {
			<span class="this">this</span>.<span class="variable">x</span> = <span class="variable">p</span>.<span class="variable">x</span>;
			<span class="this">this</span>.<span class="variable">y</span> = <span class="variable">p</span>.<span class="variable">y</span>;
			<span class="keyword">return</span> <span class="this">this</span>;
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @methodOf jo.Point
	 * @description returns a clone of itself
	 * @returns {jo.Point}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">clone</span> : <span class="keyword">function</span>() {
			<span class="keyword">return</span> <span class="keyword">new</span> <span class="variable">jo</span>.<span class="class">Point</span>(<span class="this">this</span>.<span class="variable">x</span>, <span class="this">this</span>.<span class="variable">y</span>);
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @methodOf jo.Point
	 * @description returns true if equal
	 * @param p
	 * @returns {Boolean}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">equal</span> : <span class="keyword">function</span>(<span class="variable">p</span>) {
			<span class="keyword">return</span> <span class="this">this</span>.<span class="variable">x</span> === <span class="variable">p</span>.<span class="variable">x</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="this">this</span>.<span class="variable">y</span> === <span class="variable">p</span>.<span class="variable">y</span>;
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @methodOf jo.Point
	 * @description forms a vector with length 1 from angle, where zero is
	 *              straight right
	 * @param angle
	 * @returns {this}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">fromAngle</span> : <span class="keyword">function</span>(<span class="variable">angle</span>) {
			<span class="this">this</span>.<span class="variable">x</span> = <span class="class">Math</span>.<span class="variable">cos</span>(<span class="variable">angle</span>);
			<span class="this">this</span>.<span class="variable">y</span> = <span class="class">Math</span>.<span class="variable">sin</span>(<span class="variable">angle</span>);
			<span class="keyword">return</span> <span class="this">this</span>;
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @methodOf jo.Point
	 * @description
	 * @returns {number}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">toAngle</span> : <span class="keyword">function</span>() {
			<span class="keyword">var</span> <span class="variable">angle</span> = <span class="class">Math</span>.<span class="variable">atan2</span>(<span class="this">this</span>.<span class="variable">y</span>, <span class="this">this</span>.<span class="variable">x</span>); <span class="comment">// weird weird atan2</span>
			<span class="variable">angle</span> = <span class="variable">angle</span> &<span class="variable">lt</span>; <span class="number integer">0</span> ? (<span class="number integer">2</span> * <span class="class">Math</span>.<span class="class">PI</span>) + <span class="variable">angle</span> : <span class="variable">angle</span>;
			<span class="keyword">return</span> <span class="variable">angle</span>;
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @methodOf jo.Point
	 * @description dot product or, scalar product
	 * @param {jo.Point}
	 *            a other Point
	 * @returns {Number}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">dot</span> : <span class="keyword">function</span>(<span class="variable">a</span>) {
			<span class="keyword">return</span> <span class="this">this</span>.<span class="variable">x</span> * <span class="variable">a</span>.<span class="variable">x</span> + <span class="this">this</span>.<span class="variable">y</span> * <span class="variable">a</span>.<span class="variable">y</span>;
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @methodOf jo.Point
	 * @description length of the vector times length of the vector,
	 *              sometimes you just need to compare the square
	 * @returns {Number}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">lengthSqr</span> : <span class="keyword">function</span>() {
			<span class="keyword">return</span> <span class="this">this</span>.<span class="variable">x</span> * <span class="this">this</span>.<span class="variable">x</span> + <span class="this">this</span>.<span class="variable">y</span> * <span class="this">this</span>.<span class="variable">y</span>;
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @methodOf jo.Point
	 * @description length of the vector
	 * @returns {Number}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">length</span> : <span class="keyword">function</span>() {
			<span class="keyword">return</span> <span class="class">Math</span>.<span class="variable">sqrt</span>(<span class="this">this</span>.<span class="variable">x</span> * <span class="this">this</span>.<span class="variable">x</span> + <span class="this">this</span>.<span class="variable">y</span> * <span class="this">this</span>.<span class="variable">y</span>);
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @methodOf jo.Point
	 * @description normalizes the vector
	 * @returns {this}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">normalize</span> : <span class="keyword">function</span>() {
			<span class="keyword">return</span> <span class="this">this</span>.<span class="variable">multiply</span>(<span class="this">this</span>.<span class="variable">length</span>());
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @methodOf jo.Point
	 * @description divides the vector with its length, to set its length to
	 *              1
	 * @returns {this}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">normalized</span> : <span class="keyword">function</span>() {
			<span class="keyword">return</span> <span class="this">this</span>.<span class="variable">times</span>(<span class="number integer">1</span> / <span class="this">this</span>.<span class="variable">length</span>());
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @methodOf jo.Point
	 * @description return the left Normal, width the same length as the
	 *              vector
	 * @returns {jo.Point}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">leftNormal</span> : <span class="keyword">function</span>() {
			<span class="keyword">return</span> <span class="keyword">new</span> <span class="variable">jo</span>.<span class="class">Point</span>(-<span class="this">this</span>.<span class="variable">y</span>, <span class="this">this</span>.<span class="variable">x</span>);
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @methodOf jo.Point
	 * @description return the right Normal, width the same length as the
	 *              vector
	 * @returns {jo.Point}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">rightNormal</span> : <span class="keyword">function</span>() {
			<span class="keyword">return</span> <span class="keyword">new</span> <span class="variable">jo</span>.<span class="class">Point</span>(<span class="this">this</span>.<span class="variable">y</span>, -<span class="this">this</span>.<span class="variable">x</span>);
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @methodOf jo.Point
	 * @description returns the sum of this and another vector
	 * @param {jo.Point} p
	 * @returns {jo.Point}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">plus</span> : <span class="keyword">function</span>(<span class="variable">p</span>) {
			<span class="keyword">return</span> <span class="keyword">new</span> <span class="variable">jo</span>.<span class="class">Point</span>(<span class="this">this</span>.<span class="variable">x</span> + <span class="variable">p</span>.<span class="variable">x</span>, <span class="this">this</span>.<span class="variable">y</span> + <span class="variable">p</span>.<span class="variable">y</span>);
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @methodOf jo.Point
	 * @description returns the difference of this and another vector
	 * @param {jo.Point} p
	 * @returns {jo.Point}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">minus</span> : <span class="keyword">function</span>(<span class="variable">p</span>) {
			<span class="keyword">return</span> <span class="keyword">new</span> <span class="variable">jo</span>.<span class="class">Point</span>(<span class="this">this</span>.<span class="variable">x</span> - <span class="variable">p</span>.<span class="variable">x</span>, <span class="this">this</span>.<span class="variable">y</span> - <span class="variable">p</span>.<span class="variable">y</span>);
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @methodOf jo.Point
	 * @description returns this multiplied with a scalar
	 * @param {Number} a
	 * @returns {jo.Point}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">times</span> : <span class="keyword">function</span>(<span class="variable">a</span>) {
			<span class="keyword">return</span> <span class="keyword">new</span> <span class="variable">jo</span>.<span class="class">Point</span>(<span class="this">this</span>.<span class="variable">x</span> * <span class="variable">a</span>, <span class="this">this</span>.<span class="variable">y</span> * <span class="variable">a</span>);
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @methodOf jo.Point
	 * @description returns this divided by a scalar
	 * @param {Number}
	 *            a
	 * @returns {jo.Point}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">dividedBy</span> : <span class="keyword">function</span>(<span class="variable">a</span>) {
			<span class="keyword">return</span> <span class="keyword">new</span> <span class="variable">jo</span>.<span class="class">Point</span>(<span class="this">this</span>.<span class="variable">x</span> <span class="regexp">/ a, this.y /</span> <span class="variable">a</span>);
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @methodOf jo.Point
	 * @description returns new point which is this negated
	 * @returns {jo.Point}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">neg</span> : <span class="keyword">function</span>() {
			<span class="keyword">return</span> <span class="keyword">new</span> <span class="variable">jo</span>.<span class="class">Point</span>(<span class="this">this</span>.<span class="variable">x</span> * -<span class="number integer">1</span>, <span class="this">this</span>.<span class="variable">y</span> * -<span class="number integer">1</span>);
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @methodOf jo.Point
	 * @description adds another vector to this
	 * @param {jo.Point} p
	 * @returns {this}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">add</span> : <span class="keyword">function</span>(<span class="variable">p</span>) {
			<span class="this">this</span>.<span class="variable">x</span> += <span class="variable">p</span>.<span class="variable">x</span>;
			<span class="this">this</span>.<span class="variable">y</span> += <span class="variable">p</span>.<span class="variable">y</span>;
			<span class="keyword">return</span> <span class="this">this</span>;	
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @methodOf jo.Point
	 * @description subtracts another vector from this
	 * @param {jo.Point}  p
	 * @returns {this}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">subtract</span> : <span class="keyword">function</span>(<span class="variable">p</span>) {
			<span class="this">this</span>.<span class="variable">x</span> -= <span class="variable">p</span>.<span class="variable">x</span>;
			<span class="this">this</span>.<span class="variable">y</span> -= <span class="variable">p</span>.<span class="variable">y</span>;
			<span class="keyword">return</span> <span class="this">this</span>;
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @methodOf jo.Point
	 * @description multiplies this with a scalar
	 * @param {Number} a
	 * @returns {this}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">multiply</span> : <span class="keyword">function</span>( <span class="variable">a</span> ) {
			<span class="this">this</span>.<span class="variable">x</span> *= <span class="variable">a</span>;
			<span class="this">this</span>.<span class="variable">y</span> *= <span class="variable">a</span>;
			<span class="keyword">return</span> <span class="this">this</span>;
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @methodOf jo.Point
	 * @description divides this by a scalar
	 * @param {Number} a
	 * @returns {this}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">divide</span> : <span class="keyword">function</span>( <span class="variable">a</span> ) {
			<span class="this">this</span>.<span class="variable">x</span> /= <span class="variable">a</span>;
			<span class="this">this</span>.<span class="variable">y</span> /= <span class="variable">a</span>;
			<span class="keyword">return</span> <span class="this">this</span>;
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @methodOf jo.Point
	 * @description multiplies this with -1
	 * @returns {this}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">negate</span> : <span class="keyword">function</span>() {
			<span class="this">this</span>.<span class="variable">x</span> *= -<span class="number integer">1</span>;
			<span class="this">this</span>.<span class="variable">y</span> *= -<span class="number integer">1</span>;
			<span class="keyword">return</span> <span class="this">this</span>;
		},
		<span class="variable">floor</span>: <span class="keyword">function</span>(){
			<span class="this">this</span>.<span class="variable">x</span>= <span class="class">Math</span>.<span class="variable">floor</span>(<span class="this">this</span>.<span class="variable">x</span>);
			<span class="this">this</span>.<span class="variable">y</span>= <span class="class">Math</span>.<span class="variable">floor</span>(<span class="this">this</span>.<span class="variable">y</span>);
			<span class="keyword">return</span> <span class="this">this</span>;
		}
	});
	<span class="variable">jo</span>.<span class="variable">pzero</span> = <span class="keyword">function</span>(){ <span class="keyword">return</span> <span class="keyword">new</span> <span class="variable">jo</span>.<span class="class">Point</span>(<span class="number integer">0</span>,<span class="number integer">0</span>);};
	<span class="variable">jo</span>.<span class="variable">point</span> = <span class="keyword">function</span>(<span class="variable">x</span>,<span class="variable">y</span>){<span class="keyword">return</span> <span class="keyword">new</span> <span class="variable">jo</span>.<span class="class">Point</span>(<span class="variable">x</span>,<span class="variable">y</span>);};
	<span class="keyword">return</span> <span class="variable">jo</span>.<span class="class">Point</span>;
});</code></pre>
</td>
</tr><tr class="filename"><td><h2 id="Screen.js"><a href="#">Screen</a></h2></td><td>Screen.js</td></tr><tr class="code">
<td class="docs">
<p>define([ './jo', './Surface', './Point'],function(jo, Surface, Point){</p>
</td>
<td class="code">
<pre><code>*
	 * @<span class="keyword">class</span> <span class="class">The</span> <span class="class">Screen</span> <span class="class">Surface</span> <span class="variable">handles</span> <span class="variable">screen</span> <span class="variable">updating</span> <span class="variable">and</span> <span class="variable">frame</span> <span class="variable">counting</span>
	 * @<span class="variable">augments</span> <span class="variable">jo</span>.<span class="class">Surface</span>
	 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>var viewport = function(){
		var viewportwidth;
		var viewportheight;</p>

<pre><code>	// the more standards compliant browsers (mozilla/netscape/opera/IE7) use window.innerWidth and window.innerHeight

	if (typeof window.innerWidth != 'undefined')
	{
	     viewportwidth = window.innerWidth,
	     viewportheight = window.innerHeight;
	}

       // IE6 in standards compliant mode (i.e. with a valid doctype as the first line in the document)

	else if (typeof document.documentElement != 'undefined'
	    &amp;&amp; typeof document.documentElement.clientWidth !=
	    'undefined' &amp;&amp; document.documentElement.clientWidth != 0)
	{
	      viewportwidth = document.documentElement.clientWidth,
	      viewportheight = document.documentElement.clientHeight;
	}

	// older versions of IE

	else
	{
	      viewportwidth = document.getElementsByTagName('body')[0].clientWidth,
	      viewportheight = document.getElementsByTagName('body')[0].clientHeight;
	}
	return {width: viewportwidth, height: viewportheight};

};

jo.Screen =  Surface.extend(</code></pre>
</td>
<td class="code">
<pre><code>*
		 * @<span class="variable">lends</span> <span class="variable">jo</span>.<span class="class">Screen</span>.<span class="variable">prototype</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>{
		frames : 0,
		debug : jo.debug,
		fps : 60,
		ticks : 1000 / 30,
		realFps : 30,
		realTicks : 1000 / 30,
		time : 1000 / 30,
		fixedTime : true,
		lastTime : 0,
		off : {
			x : 0,
			y : 0
		},</p>
</td>
<td class="code">
<pre><code>*
		 * @<span class="variable">constructs</span>
		 * @<span class="variable">param</span> <span class="variable">options</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>init: function (options){</p>

<pre><code>		this.fullscreen = options.fullscreen | false;

		this.width = options.width | 640;
		this.height = options.height | 480;


		this._super(this.width, this.height, options.name);
		this.checkfull();

		if(this.fullscreen){
			this.canvas.style.position = 'absolute';
			this.canvas.style.zIndex = 1;

		}
		this.fps = options.fps || 30;

		this.fixedTime = options.fixedTime | true;

		this.ticks = 1000 / this.fps;

		setInterval(jo.bind(this.update, this), this.ticks);

		this.ctx.font = '10px monospace';

		// calculate the offset for the mouse
		this.calcOffset();
		jo.log('screen done');

	},
	checkfull: function(){
		if(this.fullscreen){
			var view = viewport();

			if(this.width !== view.width || this.height!==view.height){
				this.canvas.height = this.height = view.height;
				this.canvas.width = this.width = view.width;
			}

		}
	},</code></pre>
</td>
<td class="code">
<pre><code>*
		 * <span class="class">This</span> <span class="variable">gets</span> <span class="variable">repeated</span> <span class="variable">throughout</span> <span class="variable">the</span> <span class="variable">game</span>
		 * @<span class="variable">private</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>update: function(){
			this._draw();
			this.checkfull();
			if(this.debug){
				this.ctx.font = '10px monospace';
				this.fill = 'white';
				this.stroke = 0;
				this.text(null,{x: 5, y: 5}, 'debugmode fps: ' + this.realFps.toFixed(2) + ' ticks: ' + this.realTicks);
			}	
			this.frames += 1;
			this.realTicks = this.time - this.lastTime;
			this.realFps = this.realFps / 2 + (500 / this.realTicks);
			var date = new Date();
			this.lastTime = this.time;
			this.time = date.getTime();
		},</p>
</td>
<td class="code">
<pre><code>*
		 * <span class="variable">pass</span> <span class="variable">a</span> <span class="keyword">function</span> <span class="variable">and</span> <span class="variable">put</span> <span class="variable">all</span> <span class="variable">your</span> <span class="variable">drawing</span> <span class="variable">here</span>, <span class="variable">it</span> <span class="variable">is</span> <span class="variable">the</span> <span class="variable">first</span> <span class="variable">thing</span>, <span class="variable">that</span> <span class="variable">runs</span> <span class="variable">every</span> <span class="variable">frame</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>draw: function(fn){
			if(typeof fn === 'function'){
				this._draw = fn;
			}			
		},</p>
</td>
<td class="code">
<pre><code>*
		 * @<span class="variable">private</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>_draw: function(){
			//overwrite this in your game setup
			this.clear(this.color(120,120,120));
		},</p>
</td>
<td class="code">
<pre><code>*
		 * @<span class="variable">private</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>calcOffset: function(){
			this.offset= new Point();
			this.offset.x=0;
			this.offset.y=0;
			 var el = this.ctx.canvas;
	            while (el != null) {
	                this.offset.x += el.offsetLeft;
	                this.offset.y += el.offsetTop;
	                el = el.offsetParent;
	            }
		}
	});</p>

<pre><code>return jo.Screen;</code></pre>

<p>});</p>
</td>
<td class="code">

</td>
</tr><tr class="filename"><td><h2 id="Sprite.js"><a href="#">Sprite</a></h2></td><td>Sprite.js</td></tr><tr class="code">
<td class="docs">
<ul><li><strong>name</strong>: <em>jo</em>
.Sprite</li><li><p><strong>class</strong>: <em>Sprite</em>
loads and draws Images
## </p></li><li><p><strong>property</strong>: <em>number</em>  width The Images' Width</p></li><li><p><strong>property</strong>: <em>number</em>  height The Images' Height</p></li></ul>
</td>
<td class="code">
<pre><code><span class="variable">define</span>([ <span class="string">'./jo'</span>, <span class="string">'./Point'</span> ], <span class="keyword">function</span>(<span class="variable">jo</span>, <span class="class">Point</span>) {

	<span class="variable">jo</span>.<span class="class">Sprite</span> = <span class="variable">jo</span>.<span class="class">Class</span>.<span class="variable">extend</span>({
		<span class="variable">width</span> : <span class="number integer">0</span>,
		<span class="variable">height</span> : <span class="number integer">0</span>,
		<span class="variable">loadCall</span> : <span class="keyword">null</span>,</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @constructor
	 * @param {string} src takes an image URL 
	 * @param {function} loadCall callback function, gets called when image is loaded
	 * @methodOf jo.web.Sprite
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">init</span> : <span class="keyword">function</span>(<span class="variable">src</span>, <span class="variable">loadCall</span>) {
			<span class="this">this</span>.<span class="variable">src</span> = <span class="variable">src</span>;
			<span class="this">this</span>.<span class="variable">img</span> = <span class="keyword">new</span> <span class="class">Image</span>();
			<span class="this">this</span>.<span class="variable">img</span>.<span class="variable">src</span> = <span class="variable">src</span>;
			<span class="this">this</span>.<span class="variable">loadCall</span> = <span class="variable">loadCall</span>;
			<span class="this">this</span>.<span class="variable">img</span>.<span class="variable">onload</span> = <span class="variable">jo</span>.<span class="variable">bind</span>(<span class="this">this</span>.<span class="variable">onLoad</span>, <span class="this">this</span>);
			<span class="comment">//this.joObject ='Sprite';</span>
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @param {object} options an optional set of options, such as angle, pivot and frame &lt;br/&gt;
	 * 	angle: an angle in radians &lt;br/&gt;
	 *  pivot: a point or a direction supported directions are:
	 *  &lt;ul&gt; &lt;li&gt;'center'&lt;/li&gt;
	 *  &lt;li&gt;'top'&lt;/li&gt;
	 *  &lt;li&gt;'bottom'&lt;/li&gt;
	 *  &lt;li&gt;'left'&lt;/li&gt;
	 *  &lt;li&gt;'right'&lt;/li&gt;
	 *  &lt;li&gt;'topleft'&lt;/li&gt;
	 *  &lt;li&gt;'topright'&lt;/li&gt;
	 *  &lt;li&gt;'bottomleft'&lt;/li&gt;
	 *  &lt;li&gt;'bottomright'&lt;/li&gt;
	 *  &lt;/ul&gt;
	 *  default is topleft &lt;br/&gt;
	 *  frame: {x: {Number}, y: {Number}, width: {Number}, height: {Number}}
	 * @param {object} position a position object containing x and y
	 * @param {jo.Surface} surface A Jomoho Surface e.g. screen
	 * @methodOf jo.web.Sprite
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">draw</span> : <span class="keyword">function</span>(<span class="variable">options</span>, <span class="variable">position</span>, <span class="variable">surface</span>) {
			
			<span class="variable">surface</span>.<span class="variable">ctx</span>.<span class="variable">save</span>();
			<span class="variable">surface</span>.<span class="variable">ctx</span>.<span class="variable">translate</span>(<span class="variable">position</span>.<span class="variable">x</span>, <span class="variable">position</span>.<span class="variable">y</span>);
			
			<span class="keyword">var</span> <span class="variable">srcW</span> = <span class="variable">width</span> = <span class="this">this</span>.<span class="variable">width</span>, 
			<span class="variable">srcH</span> = <span class="variable">height</span> = <span class="this">this</span>.<span class="variable">height</span>,
			<span class="variable">x</span> = <span class="number integer">0</span>, 
			<span class="variable">y</span> = <span class="number integer">0</span>;

			<span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="variable">options</span> === <span class="string">'object'</span>){
				<span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="variable">options</span>.<span class="variable">angle</span> !== <span class="string">'undefined'</span>){
					<span class="variable">surface</span>.<span class="variable">ctx</span>.<span class="variable">rotate</span>(<span class="variable">options</span>.<span class="variable">angle</span>);
				}
				
				<span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="variable">options</span>.<span class="variable">frame</span> === <span class="string">'object'</span>){
					<span class="variable">srcW</span> = <span class="variable">width</span> = <span class="variable">options</span>.<span class="variable">frame</span>.<span class="variable">width</span>;
					<span class="variable">srcH</span> = <span class="variable">height</span> = <span class="variable">options</span>.<span class="variable">frame</span>.<span class="variable">height</span>;
					<span class="variable">x</span> = <span class="variable">options</span>.<span class="variable">frame</span>.<span class="variable">x</span>;
					<span class="variable">y</span> = <span class="variable">options</span>.<span class="variable">frame</span>.<span class="variable">y</span>;
				}
				<span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="variable">options</span>.<span class="variable">resize</span> === <span class="string">'number'</span>){
					<span class="variable">width</span> *= <span class="variable">options</span>.<span class="variable">resize</span>;
					<span class="variable">height</span> *= <span class="variable">options</span>.<span class="variable">resize</span>;
				}
				<span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="variable">options</span>.<span class="variable">pivot</span> !== <span class="string">'undefined'</span>){					
					<span class="keyword">if</span>(<span class="variable">options</span>.<span class="variable">pivot</span> === <span class="string">'center'</span>){
						<span class="variable">surface</span>.<span class="variable">ctx</span>.<span class="variable">translate</span>(-<span class="variable">width</span> <span class="regexp">/ 2, -height /</span> <span class="number integer">2</span>);
					}<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">options</span>.<span class="variable">pivot</span> === <span class="string">'top'</span>){
						<span class="variable">surface</span>.<span class="variable">ctx</span>.<span class="variable">translate</span>(-<span class="variable">width</span> / <span class="number integer">2</span>, <span class="number integer">0</span>);
					}<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">options</span>.<span class="variable">pivot</span> === <span class="string">'topright'</span>){
						<span class="variable">surface</span>.<span class="variable">ctx</span>.<span class="variable">translate</span>(-<span class="variable">width</span>, <span class="number integer">0</span>);
					}<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">options</span>.<span class="variable">pivot</span> === <span class="string">'bottom'</span>){
						<span class="variable">surface</span>.<span class="variable">ctx</span>.<span class="variable">translate</span>(-<span class="variable">width</span> / <span class="number integer">2</span>, -<span class="variable">height</span>);
					}<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">options</span>.<span class="variable">pivot</span> === <span class="string">'bottomleft'</span>){
						<span class="variable">surface</span>.<span class="variable">ctx</span>.<span class="variable">translate</span>(<span class="number integer">0</span>, -<span class="variable">height</span>);
					}<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">options</span>.<span class="variable">pivot</span> === <span class="string">'bottomright'</span>){
						<span class="variable">surface</span>.<span class="variable">ctx</span>.<span class="variable">translate</span>(-<span class="variable">width</span>, -<span class="variable">height</span>);
					}<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">options</span>.<span class="variable">pivot</span> === <span class="string">'left'</span>){
						<span class="variable">surface</span>.<span class="variable">ctx</span>.<span class="variable">translate</span>(<span class="number integer">0</span>, -<span class="variable">height</span> / <span class="number integer">2</span>);
					}<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">options</span>.<span class="variable">pivot</span> === <span class="string">'right'</span>){
						<span class="variable">surface</span>.<span class="variable">ctx</span>.<span class="variable">translate</span>(-<span class="variable">width</span> , -<span class="variable">height</span> / <span class="number integer">2</span>);
					}
					<span class="comment">//custom Point is possible aswell</span>
					<span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="variable">options</span>.<span class="variable">pivot</span>.<span class="variable">x</span> !== <span class="string">'undefined'</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="keyword">typeof</span> <span class="variable">options</span>.<span class="variable">pivot</span>.<span class="variable">y</span> !== <span class="string">'undefined'</span>){
						<span class="variable">surface</span>.<span class="variable">ctx</span>.<span class="variable">translate</span>(<span class="variable">options</span>.<span class="variable">pivot</span>.<span class="variable">x</span>, <span class="variable">options</span>.<span class="variable">pivot</span>.<span class="variable">y</span>);
					}
				}				
			}
			<span class="variable">surface</span>.<span class="variable">ctx</span>.<span class="variable">drawImage</span>(<span class="this">this</span>.<span class="variable">img</span>, <span class="variable">x</span>, <span class="variable">y</span>, <span class="variable">srcW</span>, <span class="variable">srcH</span>, <span class="number integer">0</span>, <span class="number integer">0</span>, <span class="variable">width</span>, <span class="variable">height</span>);
			<span class="variable">surface</span>.<span class="variable">ctx</span>.<span class="variable">restore</span>();
		}
	});

	<span class="keyword">return</span> <span class="variable">jo</span>.<span class="class">Sprite</span>;
});</code></pre>
</td>
</tr><tr class="filename"><td><h2 id="Surface.js"><a href="#">Surface</a></h2></td><td>Surface.js</td></tr><tr class="code">
<td class="docs">
<p>define([ './jo', './Point' ], function(jo, Point) {</p>
</td>
<td class="code">
<pre><code>*
	 * @<span class="keyword">class</span> <span class="class">A</span> <span class="variable">surface</span> <span class="variable">to</span> <span class="variable">draw</span> <span class="variable">on</span> 
	 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>jo.Surface = jo.Class.extend(</p>
</td>
<td class="code">
<pre><code>*
	 * @<span class="variable">lends</span> <span class="variable">jo</span>.<span class="class">Surface</span>.<span class="variable">prototype</span>
	 * @<span class="variable">property</span> <span class="variable">width</span>
	 * @<span class="variable">property</span> <span class="variable">height</span>
	 * @<span class="variable">property</span> <span class="variable">fill</span>
	 * @<span class="variable">property</span> <span class="variable">stroke</span>
	 * @<span class="variable">property</span> <span class="variable">canvas</span>
	 * @<span class="variable">property</span> <span class="variable">ctx</span>
	 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>{
		width : 0,
		height : 0,
		fill : 0,
		stroke : 0,
		canvas : null,</p>
</td>
<td class="code">
<pre><code>*
		 * @<span class="variable">constructs</span>
		 * @<span class="variable">param</span> <span class="variable">width</span>
		 * @<span class="variable">param</span> <span class="variable">height</span>
		 * @<span class="variable">param</span> <span class="variable">name</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>init : function(width, height, name){
			if(typeof (name) === 'undefined') {
				name = '';
			}
			if(name.substring(0, 1) === '#'){
				var name = name.substring(1, name.length);
				this.canvas = document.getElementById(name);
			} else {
				this.canvas = document.createElement('canvas');
				this.canvas.setAttribute('id', name);
			}
			if(this.canvas &amp;&amp; this.canvas.getContext){
				this.ctx = this.canvas.getContext('2d');			
				this.canvas.height = this.height = height;
				this.canvas.width = this.width = width;</p>

<pre><code>			this.ctx.font = '10px monospace';
		}else {				
			alert('Please use a browser with canvas support');
		}
	},</code></pre>
</td>
<td class="code">
<pre><code>*
		 * @<span class="variable">private</span>
		 * @<span class="variable">param</span> <span class="variable">f</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>font : function(f){
			this.ctx.font = f;
		},</p>
</td>
<td class="code">
<pre><code>*
		 * @<span class="variable">private</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>setPaint : function(){
			if(this.fill){
				this.ctx.fillStyle = this.fill;
			}
			if(this.stroke){
				this.ctx.strokeStyle = this.stroke;
			}
		},</p>
</td>
<td class="code">
<pre><code>*
		 * 
		 * @<span class="variable">param</span> <span class="variable">r</span>
		 * @<span class="variable">param</span> <span class="variable">g</span>
		 * @<span class="variable">param</span> <span class="variable">b</span>
		 * @<span class="variable">param</span> <span class="variable">a</span>
		 * @<span class="variable">returns</span> {<span class="class">String</span>}
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>color : function(r, g, b, a){
			r = Math.floor(r);
			g = Math.floor(g);
			b = Math.floor(b);</p>

<pre><code>		if (typeof (a) === 'undefined'){
			return 'rgb(' + r + ',' + g + ',' + b + ')';
		} else {
			a = Math.floor(a);
			return 'rgba(' + r + ',' + g + ',' + b + ',' + a + ')';
		}
	},</code></pre>
</td>
<td class="code">
<pre><code>*
		 * 
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>push : function(){
			this.ctx.save();
		},</p>
</td>
<td class="code">
<pre><code>*
		 * 
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>pop : function(){
			this.ctx.restore();
		},</p>
</td>
<td class="code">
<pre><code>*
		 * 
		 * @<span class="variable">param</span> <span class="variable">angle</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>rotate : function(angle){
			this.ctx.rotate(angle);
		},</p>
</td>
<td class="code">
<pre><code>*
		 * 
		 * @<span class="variable">param</span> <span class="variable">position</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>translate : function(position) {
			this.ctx.translate(position.x, position.y);
		},</p>
</td>
<td class="code">
<pre><code>*
		 * 
		 * @<span class="variable">param</span> <span class="variable">color</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>clear : function(color){
			if (typeof color === 'undefined') {
				this.ctx.clearRect(0, 0, this.width, this.height);
			} else {
				this.ctx.background = color;
				this.ctx.clearRect(0, 0, this.width, this.height);
			}		
		},</p>
</td>
<td class="code">
<pre><code>*
		 * @<span class="variable">private</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>resetOptions: function(){
			this.stroke = 'black';
			this.fill = 'white';
			this.font('10px monospace');
			this.ctx.textBaseline = 'top';
			this.ctx.textAlign = 'start';
		},</p>
</td>
<td class="code">
<pre><code>*
		 * @<span class="variable">private</span>
		 * @<span class="variable">param</span> <span class="variable">options</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>readOptions : function(options){
			//escape opportunity to use previous setting
			if(options === -1){
				return;
			}</p>

<pre><code>		this.resetOptions();
		if(typeof options === 'object'){
			if(typeof options.font !== 'undefined'){
				this.font(options.font);
			}
			if(typeof options.baseline !== 'undefined'){
				this.ctx.textBaseline = options.baseline;
			}
			if(typeof options.align !== 'undefined'){
				this.ctx.textAlign = options.align;
			}				

			if(typeof options.stroke !== 'undefined'){
				this.stroke = options.stroke;
			}
			if(typeof options.fill !== 'undefined'){
				this.fill = options.fill;
			}

		}
		this.setPaint();
	},</code></pre>
</td>
<td class="code">
<pre><code>*
		 * 
		 * @<span class="variable">param</span> <span class="variable">options</span>
		 * @<span class="variable">param</span> <span class="variable">position</span>
		 * @<span class="variable">param</span> <span class="variable">width</span>
		 * @<span class="variable">param</span> <span class="variable">height</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>rect : function(options, position, width, height){
			this.readOptions(options);
			if (this.fill) {
				this.ctx.fillStyle = this.fill;
				this.ctx.fillRect(position.x, position.y, width, height);
			}
			if (this.stroke){
				this.ctx.strokeStyle = this.stroke;
				this.ctx.strokeRect(position.x, position.y, width, height);
			}
		},</p>
</td>
<td class="code">
<pre><code>*
		 * <span class="variable">draws</span> <span class="variable">a</span> <span class="variable">circle</span> <span class="variable">at</span> <span class="variable">a</span> <span class="variable">specific</span> <span class="variable">position</span>
		 * @<span class="variable">param</span> <span class="variable">options</span>
		 * @<span class="variable">param</span> <span class="variable">position</span>
		 * @<span class="variable">param</span> <span class="variable">radius</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>circle : function(options, position, radius){
			this.readOptions(options);</p>

<pre><code>		this.ctx.beginPath();
			this.ctx.arc(position.x, position.y, radius, 0, 2 * Math.PI, false);
			if(this.fill) {
				this.ctx.fill();
			}
			if(this.stroke) {
				this.ctx.stroke();
			}
		this.ctx.closePath();

	},</code></pre>
</td>
<td class="code">
<pre><code>*
		 * <span class="variable">draws</span> <span class="variable">a</span> <span class="variable">line</span> <span class="variable">between</span> <span class="variable">two</span> <span class="variable">positions</span>
		 * @<span class="variable">param</span> <span class="variable">options</span>
		 * @<span class="variable">param</span> <span class="variable">position1</span>
		 * @<span class="variable">param</span> <span class="variable">position2</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>line : function(options, position1, position2) {
			this.readOptions(options);</p>

<pre><code>		this.ctx.beginPath();
			this.ctx.moveTo(position1.x, position1.y);
			this.ctx.lineTo(position2.x, position2.y);
		this.ctx.closePath();

		if (this.stroke) {
			this.ctx.stroke();
		}
	},</code></pre>
</td>
<td class="code">
<pre><code>*
		 *  <span class="variable">returns</span> <span class="variable">the</span> <span class="variable">length</span> <span class="variable">of</span> <span class="variable">a</span> <span class="variable">given</span> <span class="variable">text</span> <span class="keyword">in</span> <span class="variable">pixels</span>, 
		 *  <span class="variable">using</span> <span class="variable">the</span> <span class="variable">settings</span> <span class="variable">specified</span> <span class="keyword">in</span> <span class="variable">options</span>
		 * @<span class="variable">param</span> <span class="variable">options</span>
		 * @<span class="variable">param</span> <span class="variable">caption</span>
		 * @<span class="variable">returns</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>textLength : function(options, caption){
			this.readOptions(options);
			return this.ctx.measureText(caption).width;
		},</p>
</td>
<td class="code">
<pre><code>*
		 * <span class="variable">draws</span> <span class="variable">text</span> <span class="variable">at</span> <span class="variable">a</span> <span class="variable">certain</span> <span class="variable">position</span>
		 * @<span class="variable">param</span> <span class="variable">options</span>
		 * @<span class="variable">param</span> <span class="variable">position</span>
		 * @<span class="variable">param</span> <span class="variable">caption</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>text : function(options, position, caption) {
			this.readOptions(options);</p>

<pre><code>		if(this.fill){
			this.ctx.fillStyle = this.fill;
			this.ctx.fillText(caption, position.x, position.y);
		}
		if(this.stroke){
			this.ctx.strokeStyle = this.stroke;
			this.ctx.strokeText(caption, position.x, position.y);
		}
	},</code></pre>
</td>
<td class="code">
<pre><code>*
		 * <span class="variable">draws</span> <span class="variable">a</span> <span class="variable">sprite</span>
		 * @<span class="variable">see</span> <span class="variable">jo</span>.<span class="class">Sprite</span>.<span class="variable">draw</span>
		 * @<span class="variable">param</span> <span class="variable">options</span>
		 * @<span class="variable">param</span> <span class="variable">position</span>
		 * @<span class="variable">param</span> <span class="variable">sprite</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>drawSprite: function(options, position, sprite){
			sprite.draw(options, position, this);
		},</p>
</td>
<td class="code">
<pre><code>*
		 * <span class="variable">draws</span> <span class="variable">the</span> <span class="variable">surface</span> <span class="variable">onto</span> <span class="variable">another</span> <span class="variable">surface</span> <span class="variable">same</span> <span class="variable">parameters</span> <span class="variable">as</span> <span class="variable">jo</span>.<span class="class">Sprite</span>.<span class="variable">draw</span>
		 * @<span class="variable">see</span> <span class="variable">jo</span>.<span class="class">Sprite</span>
		 * @<span class="variable">param</span> <span class="variable">options</span>
		 * @<span class="variable">param</span> <span class="variable">position</span>
		 * @<span class="variable">param</span> <span class="variable">surface</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>draw : function(options, position, surface) {</p>

<pre><code>		surface.ctx.save();
		surface.ctx.translate(position.x, position.y);

		var srcW = width = this.width, 
			srcH = height = this.height,
			x = 0, 
			y = 0;

		if(typeof options === 'object'){
			if(typeof options.angle !== 'undefined'){
				surface.ctx.rotate(options.angle);
			}

			if(typeof options.frame === 'object'){
				srcW = width = options.frame.width;
				srcH = height = options.frame.height;
				x = options.frame.x;
				y = options.frame.y;
			}
			if(typeof options.resize === 'number'){
				width *= options.resize;
				height *= options.resize;
			}
			if(typeof options.pivot !== 'undefined'){					
				if(options.pivot === 'center'){
					surface.ctx.translate(-width / 2, -height / 2);
				}
				if(options.pivot === 'top'){
					surface.ctx.translate(-width / 2, 0);
				}
				if(options.pivot === 'topleft'){
					surface.ctx.translate(0, 0);
				}
				if(options.pivot === 'topright'){
					surface.ctx.translate(-width, 0);
				}
				if(options.pivot === 'bottom'){
					surface.ctx.translate(-width / 2, -height);
				}
				if(options.pivot === 'bottomleft'){
					surface.ctx.translate(0, -height);
				}
				if(options.pivot === 'bottomright'){
					surface.ctx.translate(-width, -height);
				}
				if(options.pivot === 'left'){
					surface.ctx.translate(0, -height / 2);
				}
				if(options.pivot === 'right'){
					surface.ctx.translate(-width , -height / 2);
				}
				//custom point is possible aswell
				if(typeof options.pivot.x !== 'undefined' &amp;&amp; typeof options.pivot.y !== 'undefined'){
					surface.ctx.translate(options.pivot.x, options.pivot.y);
				}
			}				
		}
		surface.ctx.drawImage(this.canvas, x, y, srcW, srcH, 0, 0, width, height);
		surface.ctx.restore();
	}
});

return jo.Surface;</code></pre>

<p>});</p>
</td>
<td class="code">

</td>
</tr><tr class="filename"><td><h2 id="Tile.js"><a href="#">Tile</a></h2></td><td>Tile.js</td></tr><tr class="code">
<td class="docs">
<p>define([ './jo', './Point', './Surface', './Sprite' ], 
		function(jo, Point, Surface, Sprite ) {</p>
</td>
<td class="code">
<pre><code>*
	 * @<span class="keyword">class</span> <span class="variable">handles</span> <span class="variable">tiles</span>, <span class="variable">works</span> <span class="variable">together</span> <span class="keyword">with</span> <span class="class">TileSet</span>
	 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>jo.Tile = jo.Class.extend(</p>
</td>
<td class="code">
<pre><code>*
		 * @<span class="variable">lends</span> <span class="variable">jo</span>.<span class="variable">tile</span>.<span class="variable">prototype</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>{</p>
</td>
<td class="code">
<pre><code>*
		 * @<span class="variable">constructs</span>
		 * @<span class="variable">param</span> <span class="variable">tileSet</span>
		 * @<span class="variable">param</span> <span class="variable">index</span>
		 * @<span class="variable">param</span> <span class="variable">material</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>init : function(tileSet, index, material) {
			this.index = index;
			this.material = material;
			this.tileSet = tileSet;
		},</p>
</td>
<td class="code">
<pre><code>*
		 * <span class="variable">drawing</span>
		 * @<span class="variable">param</span> <span class="variable">options</span>
		 * @<span class="variable">param</span> <span class="variable">position</span>
		 * @<span class="variable">param</span> <span class="variable">surface</span>
		 * @<span class="variable">see</span> <span class="variable">jo</span>.<span class="class">Sprite</span>.<span class="variable">draw</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>draw : function(options, position, surface) {
			options.tile = this.index;
			this.tileSet.draw(options, position, surface);
			if (sys.debug) {
				if (typeof this.material.debugColor !== undefined) {
					screen.rect({fill: this.material.debugColor}, position, this.tileSet.width, this.tileSet.height);
				}
			}
		}</p>

<pre><code>});
return jo.Tile;</code></pre>

<p>});</p>
</td>
<td class="code">

</td>
</tr><tr class="filename"><td><h2 id="TileSet.js"><a href="#">TileSet</a></h2></td><td>TileSet.js</td></tr><tr class="code">
<td class="docs">
<p>define(['./jo',
        './Class',
        './Tile',
        './Animation'],
        function(jo, Class, Tile, Animation){</p>
</td>
<td class="code">
<pre><code>*
	 * @<span class="keyword">class</span> <span class="variable">takes</span> <span class="variable">care</span> <span class="variable">of</span> <span class="class">Tiles</span>, <span class="variable">they</span> <span class="variable">can</span> <span class="variable">be</span> <span class="variable">single</span> <span class="variable">frames</span> <span class="variable">or</span> <span class="variable">looping</span> <span class="variable">animations</span>
	 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>jo.TileSet = jo.Object.extend(</p>
</td>
<td class="code">
<pre><code>*
		 * @<span class="variable">lends</span> <span class="variable">jo</span>.<span class="class">TileSet</span>.<span class="variable">prototype</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>{
		tiles: [],</p>
</td>
<td class="code">
<pre><code>*
		 * @<span class="variable">constructs</span> 
		 * @<span class="variable">param</span> <span class="variable">tiles</span> <span class="variable">an</span> <span class="variable">array</span> <span class="variable">of</span> <span class="variable">tile</span> <span class="variable">definitions</span> <span class="variable">can</span> <span class="variable">be</span> <span class="variable">indexes</span> <span class="variable">or</span> <span class="variable">or</span> <span class="variable">animation</span> <span class="variable">arrays</span>
		 * @<span class="variable">param</span> <span class="variable">width</span>
		 * @<span class="variable">param</span> <span class="variable">height</span>
		 * @<span class="variable">param</span> <span class="variable">sprite</span>
		 * @<span class="variable">see</span> <span class="variable">jo</span>.<span class="class">Animation</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>init: function(opt){
			this._super(opt);
			this.width = opt.width;
			this.height = opt.height;
			this.sprite = opt.sprite;
			this.tiles = this.readTiles(opt.tiles);
			this.solid=[];
		},</p>
</td>
<td class="code">
<pre><code>*
		 * <span class="variable">reads</span> <span class="variable">the</span> <span class="variable">tiles</span> <span class="variable">array</span>
		 * @<span class="variable">param</span> <span class="variable">tiles</span>
		 * @<span class="variable">returns</span> <span class="variable">transformed</span> <span class="variable">tiles</span> <span class="variable">array</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>readTiles: function(tiles){
			if(typeof tiles === 'undefined'){
				tiles = [];
			}
			if(typeof tiles.length !== 'undefined'){
				for(var i=0; i&lt; tiles.length; i++){
					//A Tile can be an Animation	
					if(typeof tiles[i] === 'object'){
						tiles[i] = new Animation(tiles[i], this.width, this.height, this.sprite);</p>

<pre><code>				}else{//or just a single Frame.
					tiles[i] = new Animation([{i: tiles[i], t: 200}], this.width, this.height, this.sprite);
				}				
			}
		}
		return tiles;
	},
	readTile: function(tile){
		//A Tile can be an Animation	
		if(typeof tile === 'object'){
			tile = new Animation(tile, this.width, this.height, this.sprite);

		}else{//or just a single Frame.
			tile = new Animation([{i: tile, t: 200}], this.width, this.height, this.sprite);
		}
	},
	push: function(tile){
		this.tiles.push(this.readTile(tile));
	},</code></pre>
</td>
<td class="code">
<pre><code>*
		 * <span class="variable">advances</span> <span class="variable">the</span> <span class="variable">tile</span> <span class="variable">animations</span>
		 * @<span class="variable">param</span> <span class="variable">ticks</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>update: function(ticks){
			for(var i=0; i&lt; this.tiles.length; i++){
				this.tiles[i].update(ticks);
			}
		},</p>
</td>
<td class="code">
<pre><code>*
		 * <span class="variable">draws</span> <span class="variable">a</span> <span class="variable">tile</span> <span class="variable">specified</span> <span class="variable">by</span> <span class="variable">options</span>.<span class="variable">tile</span>
		 * @<span class="variable">param</span> <span class="variable">options</span>
		 * @<span class="variable">param</span> <span class="variable">position</span>
		 * @<span class="variable">param</span> <span class="variable">surface</span>
		 * @<span class="variable">see</span> <span class="variable">jo</span>.<span class="class">Sprite</span>.<span class="variable">draw</span> <span class="variable">jo</span>.<span class="class">Animation</span>.<span class="variable">draw</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>draw: function(options, position, surface){
			if(typeof options.tile !== 'number'){
				options.tile = 0;
			}
			this.tiles[options.tile].draw(options, position, surface);
		},
		getCss: function(t){
			var fr,
			self=this,
			css = function(t){
				fr= self.tiles[t].getDrawFrame(0);
				return 'background: url('+self.sprite.src+') -'+fr.x+'px -'+fr.y+'px;'
						+'width: '+fr.width+'px ; height: '+fr.height+'px;';
			};
			if(t){
				return css(t);
			}else{
				var ar=[];
				for(var i in this.tiles){
					ar.push(css(i));
				}
				return ar;
			}
		}
	});
	return jo.TileSet;
});</p>
</td>
<td class="code">

</td>
</tr><tr class="filename"><td><h2 id="Tilemap.js"><a href="#">Tilemap</a></h2></td><td>Tilemap.js</td></tr><tr class="code">
<td class="docs">
<p>define([ './jo', './Grid', './Point', './Tile', './TileSet', './Camera' ], </p>

<pre><code>function(jo, Grid, Point, Tile, TileSet, Camera) {</code></pre>
</td>
<td class="code">
<pre><code>*
	 * @<span class="keyword">class</span> <span class="variable">holds</span> <span class="class">Level</span> <span class="variable">data</span> 
	 * @<span class="variable">augments</span> <span class="variable">jo</span>.<span class="class">Grid</span>
	 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>jo.TileMap = Grid.extend(</p>
</td>
<td class="code">
<pre><code>*
		 * @<span class="variable">lends</span> <span class="variable">jo</span>.<span class="class">Tilemap</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>{
			joObject: 'TileMap',</p>
</td>
<td class="code">
<pre><code>*
		 * @<span class="variable">constructs</span>
		 * @<span class="variable">param</span> <span class="variable">options</span>
		 *  <span class="variable">width</span>
		 *  <span class="variable">height</span>
		 *  <span class="variable">tileSet</span>
		 *  <span class="variable">data</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>init : function(opt) {
			this._super(opt);</p>

<pre><code>		this.tileSet = opt.tileSet;
		this._clearTo({index: -1});

		if(opt.data &amp;&amp; opt.data.length === this.data.length){
			this.data = opt.data;
		}
	},</code></pre>
</td>
<td class="code">
<pre><code>*
		 * <span class="variable">update</span> <span class="variable">animations</span>
		 * @<span class="variable">param</span> <span class="variable">ticks</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>update : function(ticks) {
			this._super(ticks);
			this.tileSet.update(ticks);
		},</p>
</td>
<td class="code">
<pre><code>*
		 * <span class="variable">draws</span> <span class="variable">the</span> <span class="variable">level</span>, <span class="variable">will</span> <span class="variable">not</span> <span class="variable">crop</span> <span class="variable">tiles</span> <span class="variable">that</span> <span class="variable">go</span> <span class="variable">over</span> <span class="variable">the</span> <span class="variable">border</span> <span class="variable">of</span> <span class="variable">options</span>.<span class="variable">frame</span>
		 * @<span class="variable">param</span> <span class="variable">options</span>
		 * @<span class="variable">param</span> <span class="variable">position</span>
		 * @<span class="variable">param</span> <span class="variable">surface</span>
		 * @<span class="variable">see</span> <span class="variable">jo</span>.<span class="class">Sprite</span>.<span class="variable">draw</span>
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>draw : function(options, position, surface) {
			var tw = this.tileSet.width,
				th = this.tileSet.height;</p>

<pre><code>		var frame = {x: jo.game.cam.x, y: jo.game.cam.y, width: surface.width, height: surface.height};
		if(typeof options.frame !== 'undefined'){
			frame = options.frame;
		}

		var con = this.convertFrame(frame);

		for(var i = con.y; i &lt; con.y + con.height; i++) {
			for(var j = con.x; j &lt; con.x + con.width; j++) {
				var index = this.get(j, i).index;
				var pos = new Point(j * tw, i * th);
				pos = pos.add(position);
				var p = jo.game.cam.toScreen(pos);
				if(index &gt;= 0){
					this.tileSet.draw({tile: index}, p, surface);						
				}
				if(options.grid){
					surface.rect({fill:0, stroke: '#ccc'}, p, tw,th);
				}
			}
		}
		this._super();
	},</code></pre>
</td>
<td class="code">
<pre><code>*
		 * <span class="keyword">return</span> <span class="variable">an</span> <span class="variable">object</span> <span class="variable">containing</span> <span class="variable">tile</span> <span class="variable">information</span>
		 * @<span class="variable">param</span> <span class="variable">x</span> {<span class="class">Number</span>}
		 * @<span class="variable">param</span> <span class="variable">y</span> {<span class="class">Number</span>}
		 * @<span class="variable">returns</span> {<span class="variable">pos</span>: {<span class="variable">jo</span>.<span class="class">Point</span>}, 
		 * <span class="variable">width</span>: {<span class="class">Number</span>}, 
		 * <span class="variable">height</span>: {<span class="class">Number</span>}, 
		 * <span class="variable">index</span>: {<span class="class">Number</span>},
		 * <span class="variable">anim</span>: {<span class="variable">jo</span>.<span class="class">Animation</span>}}
		 </code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>getTile : function(x, y) {
			var tw = this.tileSet.width,
			th = this.tileSet.height;
			return {
				pos : new Point(x <em> tw, y </em> th),
				width : tw,
				height : th,
				index : this.get(x, y).index,
				anim : this.tileSet.tiles[this.get(x, y).index]
			};
		},
		getFrame: function(){
			return {x: 0, y: 0, width: this.width<em>this.tileSet.width, height: this.height</em>this.tileSet.height};
		},</p>

<pre><code>	getIntersection: function(frame){
		var inter = [];
		var con = this.convertFrame(frame);
		for ( var i = con.y; i &lt; con.y + con.height; i++) {
			for ( var j = con.x; j &lt; con.x + con.width; j++) {
				inter.push(this.getTile(j, i));
			}
		}
		return inter;
	},
	convertFrame : function(frame){
		var con = new Point(0,0);

		var tw = this.tileSet.width,
		th = this.tileSet.height;

		var tileOff = new Point(frame.x / tw, frame.y / th);

		con.x = Math.floor(Math.max(0, tileOff.x));
		con.y = Math.floor(Math.max(0, tileOff.y));

		con.width = Math.min(Math.ceil(frame.width / tw + 1), this.width - con.x),
		con.height = Math.min(Math.ceil(frame.height / th + 1), this.height - con.y);	

		return con;
	},
	forFrame: function(frame, fn){
		var con = this.convertFrame(frame);
		for ( var i = con.x; i &lt; con.x + con.width; i++) {
			for ( var j = con.y; j &lt; con.y + con.height; j++) {
					fn(i, j, this.getTile(i,j));
			}
		}
	},
	find: function(index){
		for(var i=0; i&lt; this.width; i++){
			for(var j =0; j&lt; this.height; j++){
				if(this.get(i,j).index==index){
					return this.getTile(i,j);
				}
			}
		}
	}
});
return jo.TileMap;</code></pre>

<p>});</p>
</td>
<td class="code">

</td>
</tr><tr class="filename"><td><h2 id="cookies.js"><a href="#">cookies</a></h2></td><td>cookies.js</td></tr><tr class="code">
<td class="docs">
<p>// adapted from: www.quirksmode.org/js/cookies.html
//adapted from: http://mccormick.cx/projects/jsGameSoup/</p>

<p>define(['./jo'],function(jo){</p>
</td>
<td class="code">
<pre><code>*
		@<span class="variable">namespace</span> <span class="variable">cookie</span> <span class="variable">management</span> <span class="variable">methods</span>.
	</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>jo.cookies = {};</p>
</td>
<td class="code">
<pre><code>*
		@<span class="variable">method</span> <span class="variable">set</span> <span class="variable">the</span> <span class="variable">value</span> <span class="variable">of</span> <span class="variable">a</span> <span class="variable">cookie</span> <span class="keyword">for</span> <span class="variable">a</span> <span class="variable">certain</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">days</span>.
		@<span class="variable">param</span> <span class="variable">name</span> <span class="variable">is</span> <span class="variable">the</span> <span class="variable">key</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">cookie</span> <span class="variable">name</span>.
		@<span class="variable">param</span> <span class="variable">value</span> <span class="variable">is</span> <span class="variable">what</span> <span class="variable">to</span> <span class="variable">set</span> <span class="variable">the</span> <span class="variable">cookie</span> <span class="variable">to</span>.
		@<span class="variable">param</span> <span class="variable">days</span> <span class="variable">is</span> <span class="variable">the</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">days</span> <span class="variable">to</span> <span class="variable">set</span> <span class="variable">the</span> <span class="variable">cookie</span> <span class="keyword">for</span> <span class="variable">from</span> <span class="variable">today</span>.
	</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>jo.cookies.setCookie = function(name, value, days) {
		if (days) {
			var date = new Date();
			date.setTime(date.getTime() + (days <em> 24 </em> 60 <em> 60 </em> 2000));
			var expires = "; expires =" + date.toGMTString();
		} else {
			var expires = "";
		}
		document.cookie = name + "=" + value + expires + "; path=/";
	};</p>
</td>
<td class="code">
<pre><code>*
		@<span class="variable">method</span> <span class="variable">get</span> <span class="variable">the</span> <span class="variable">value</span> <span class="variable">of</span> <span class="variable">a</span> <span class="variable">cookie</span>.
		@<span class="variable">param</span> <span class="variable">name</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">cookie</span> <span class="variable">to</span> <span class="variable">fetch</span>.
	</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>jo.cookies.getCookie = function(name) {
		var nameEQ = name + "=";
		var ca = document.cookie.split(";");
		for (var i=0; i &lt; ca.length; i++) {
			var c = ca[i];
			while (c.charAt(0) == ' ') c = c.substring(1, c.length);
			if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
		}
		return null;
	};</p>
</td>
<td class="code">
<pre><code>*
		@<span class="variable">method</span> <span class="variable">unset</span>, <span class="variable">or</span> <span class="keyword">delete</span> <span class="variable">a</span> <span class="variable">particular</span> <span class="variable">cookie</span>.
		@<span class="variable">param</span> <span class="variable">name</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">cookie</span> <span class="variable">to</span> <span class="keyword">delete</span>.
	</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>jo.cookies.delCookie = function(name) {
		setCookie(name, "", -1);
	};</p>

<pre><code>return jo.cookies;</code></pre>

<p>});</p>
</td>
<td class="code">

</td>
</tr><tr class="filename"><td><h2 id="input.js"><a href="#">input</a></h2></td><td>input.js</td></tr><tr class="code">
<td class="docs">
<p> </p>
</td>
<td class="code">
<pre><code><span class="variable">define</span>([<span class="string">'./jo'</span>, <span class="string">'./Point'</span>], <span class="keyword">function</span>(<span class="variable">jo</span>, <span class="class">Point</span>){
	<span class="keyword">var</span> <span class="variable">keybuf</span> = <span class="number integer">270</span>;
	
	<span class="variable">jo</span>.<span class="variable">input</span> = {
		<span class="string">'MOUSE1'</span>: <span class="number integer">260</span>,
		<span class="string">'MOUSE2'</span>: <span class="number integer">261</span>,
		<span class="string">'WHEEL_UP'</span>: <span class="number integer">262</span>,
		<span class="string">'WHEEL_DOWN'</span>: <span class="number integer">263</span>,
		<span class="string">'BACKSPACE'</span>: <span class="number integer">8</span>,
		<span class="string">'TAB'</span>: <span class="number integer">9</span>,
		<span class="string">'ENTER'</span>: <span class="number integer">13</span>,
		<span class="string">'PAUSE'</span>: <span class="number integer">19</span>,
		<span class="string">'CAPS'</span>: <span class="number integer">20</span>,
		<span class="string">'ESC'</span>: <span class="number integer">27</span>,
		<span class="string">'SPACE'</span>: <span class="number integer">32</span>,
		<span class="string">'PAGE_UP'</span>: <span class="number integer">33</span>,
		<span class="string">'PAGE_DOWN'</span>: <span class="number integer">34</span>,
		<span class="string">'END'</span>: <span class="number integer">35</span>,
		<span class="string">'HOME'</span>: <span class="number integer">36</span>,
		<span class="string">'LEFT'</span>: <span class="number integer">37</span>,
		<span class="string">'UP'</span>: <span class="number integer">38</span>,
		<span class="string">'RIGHT'</span>: <span class="number integer">39</span>,
		<span class="string">'DOWN'</span>: <span class="number integer">40</span>,
		<span class="string">'INSERT'</span>: <span class="number integer">45</span>,
		<span class="string">'DELETE'</span>: <span class="number integer">46</span>,
		<span class="string">'0'</span>: <span class="number integer">48</span>,
		<span class="string">'1'</span>: <span class="number integer">49</span>,
		<span class="string">'2'</span>: <span class="number integer">50</span>,
		<span class="string">'3'</span>: <span class="number integer">51</span>,
		<span class="string">'4'</span>: <span class="number integer">52</span>,
		<span class="string">'5'</span>: <span class="number integer">53</span>,
		<span class="string">'6'</span>: <span class="number integer">54</span>,
		<span class="string">'7'</span>: <span class="number integer">55</span>,
		<span class="string">'8'</span>: <span class="number integer">56</span>,
		<span class="string">'9'</span>: <span class="number integer">57</span>,
		<span class="string">'A'</span>: <span class="number integer">65</span>,
		<span class="string">'B'</span>: <span class="number integer">66</span>,
		<span class="string">'C'</span>: <span class="number integer">67</span>,
		<span class="string">'D'</span>: <span class="number integer">68</span>,
		<span class="string">'E'</span>: <span class="number integer">69</span>,
		<span class="string">'F'</span>: <span class="number integer">70</span>,
		<span class="string">'G'</span>: <span class="number integer">71</span>,
		<span class="string">'H'</span>: <span class="number integer">72</span>,
		<span class="string">'I'</span>: <span class="number integer">73</span>,
		<span class="string">'J'</span>: <span class="number integer">74</span>,
		<span class="string">'K'</span>: <span class="number integer">75</span>,
		<span class="string">'L'</span>: <span class="number integer">76</span>,
		<span class="string">'M'</span>: <span class="number integer">77</span>,
		<span class="string">'N'</span>: <span class="number integer">78</span>,
		<span class="string">'O'</span>: <span class="number integer">79</span>,
		<span class="string">'P'</span>: <span class="number integer">80</span>,
		<span class="string">'Q'</span>: <span class="number integer">81</span>,
		<span class="string">'R'</span>: <span class="number integer">82</span>,
		<span class="string">'S'</span>: <span class="number integer">83</span>,
		<span class="string">'T'</span>: <span class="number integer">84</span>,
		<span class="string">'U'</span>: <span class="number integer">85</span>,
		<span class="string">'V'</span>: <span class="number integer">86</span>,
		<span class="string">'W'</span>: <span class="number integer">87</span>,
		<span class="string">'X'</span>: <span class="number integer">88</span>,
		<span class="string">'Y'</span>: <span class="number integer">89</span>,
		<span class="string">'Z'</span>: <span class="number integer">90</span>,
		<span class="string">'NUMPAD_0'</span>: <span class="number integer">96</span>,
		<span class="string">'NUMPAD_1'</span>: <span class="number integer">97</span>,
		<span class="string">'NUMPAD_2'</span>: <span class="number integer">98</span>,
		<span class="string">'NUMPAD_3'</span>: <span class="number integer">99</span>,
		<span class="string">'NUMPAD_4'</span>: <span class="number integer">100</span>,
		<span class="string">'NUMPAD_5'</span>: <span class="number integer">101</span>,
		<span class="string">'NUMPAD_6'</span>: <span class="number integer">102</span>,
		<span class="string">'NUMPAD_7'</span>: <span class="number integer">103</span>,
		<span class="string">'NUMPAD_8'</span>: <span class="number integer">104</span>,
		<span class="string">'NUMPAD_9'</span>: <span class="number integer">105</span>,
		<span class="string">'MULTIPLY'</span>: <span class="number integer">106</span>,
		<span class="string">'ADD'</span>: <span class="number integer">107</span>,
		<span class="string">'SUBSTRACT'</span>: <span class="number integer">109</span>,
		<span class="string">'DECIMAL'</span>: <span class="number integer">110</span>,
		<span class="string">'DIVIDE'</span>: <span class="number integer">111</span>,
		<span class="string">'F1'</span>: <span class="number integer">112</span>,
		<span class="string">'F2'</span>: <span class="number integer">113</span>,
		<span class="string">'F3'</span>: <span class="number integer">114</span>,
		<span class="string">'F4'</span>: <span class="number integer">115</span>,
		<span class="string">'F5'</span>: <span class="number integer">116</span>,
		<span class="string">'F6'</span>: <span class="number integer">117</span>,
		<span class="string">'F7'</span>: <span class="number integer">118</span>,
		<span class="string">'F8'</span>: <span class="number integer">119</span>,
		<span class="string">'F9'</span>: <span class="number integer">120</span>,
		<span class="string">'F10'</span>: <span class="number integer">121</span>,
		<span class="string">'F11'</span>: <span class="number integer">122</span>,
		<span class="string">'F12'</span>: <span class="number integer">123</span>,
		<span class="string">'SHIFT'</span>: <span class="number integer">16</span>,
		<span class="string">'CTRL'</span>: <span class="number integer">17</span>,
		<span class="string">'ALT'</span>: <span class="number integer">18</span>,
		<span class="string">'PLUS'</span>: <span class="number integer">187</span>,
		<span class="string">'COMMA'</span>: <span class="number integer">188</span>,
		<span class="string">'MINUS'</span>: <span class="number integer">189</span>,
		<span class="string">'PERIOD'</span>: <span class="number integer">190</span>,
		<span class="variable">key</span>:[],
		<span class="variable">lastKey</span>:[],
		<span class="variable">newKey</span>:[],
		<span class="variable">lastMouse</span>: <span class="keyword">new</span> <span class="class">Point</span>(<span class="number integer">0</span>, <span class="number integer">0</span>),
		<span class="variable">newMouse</span>: <span class="keyword">new</span> <span class="class">Point</span>(<span class="number integer">0</span>, <span class="number integer">0</span>),
		<span class="variable">mouse</span>: <span class="keyword">new</span> <span class="class">Point</span>(<span class="number integer">0</span>, <span class="number integer">0</span>),
		<span class="variable">reserved</span>:[],
		<span class="variable">keyInit</span>:<span class="variable">false</span>,
		<span class="variable">mouseInit</span>: <span class="variable">false</span>,
		<span class="variable">setup</span>: <span class="keyword">function</span>(){
			<span class="this">this</span>.<span class="variable">initKeys</span>();			
			<span class="this">this</span>.<span class="variable">initMouse</span>();
		},
		<span class="variable">initKeys</span>: <span class="keyword">function</span> (){
			<span class="keyword">if</span>(<span class="this">this</span>.<span class="variable">keyInit</span>){
				<span class="keyword">return</span>;
			}
			<span class="this">this</span>.<span class="variable">keyInit</span>=<span class="variable">true</span>;
			
			<span class="keyword">for</span>(<span class="keyword">var</span> <span class="variable">i</span>=<span class="number integer">0</span>; <span class="variable">i</span>&<span class="variable">lt</span>;<span class="variable">keybuf</span>; <span class="variable">i</span>++){
				<span class="this">this</span>.<span class="variable">key</span>.<span class="variable">push</span>(<span class="variable">false</span>);
				<span class="this">this</span>.<span class="variable">lastKey</span>.<span class="variable">push</span>(<span class="variable">false</span>);
				<span class="this">this</span>.<span class="variable">newKey</span>.<span class="variable">push</span>(<span class="variable">false</span>);
			}
			
			<span class="variable">window</span>.<span class="variable">addEventListener</span>(<span class="string">'keydown'</span>, <span class="variable">jo</span>.<span class="variable">bind</span>(<span class="this">this</span>.<span class="variable">keyDown</span>, <span class="this">this</span>), <span class="variable">false</span>);
			<span class="variable">window</span>.<span class="variable">addEventListener</span>(<span class="string">'keyup'</span>, <span class="variable">jo</span>.<span class="variable">bind</span>(<span class="this">this</span>.<span class="variable">keyUp</span>, <span class="this">this</span>), <span class="variable">false</span>);
			<span class="variable">jo</span>.<span class="variable">log</span>(<span class="string">'keyboard ready..'</span>);
		},
		<span class="variable">initMouse</span>: <span class="keyword">function</span> (){	
			<span class="keyword">if</span>(<span class="this">this</span>.<span class="variable">mouseInit</span>){
				<span class="keyword">return</span>;
			}
			<span class="this">this</span>.<span class="variable">mouseInit</span>=<span class="variable">true</span>;		
			<span class="variable">window</span>.<span class="variable">addEventListener</span>(<span class="string">'mousewheel'</span>, <span class="variable">jo</span>.<span class="variable">bind</span>(<span class="this">this</span>.<span class="variable">mouseWheel</span>, <span class="this">this</span>), <span class="variable">false</span>);
			
			<span class="variable">jo</span>.<span class="variable">screen</span>.<span class="variable">canvas</span>.<span class="variable">addEventListener</span>(<span class="string">'contextmenu'</span>, <span class="variable">jo</span>.<span class="variable">bind</span>(<span class="this">this</span>.<span class="variable">contextMenu</span>, <span class="this">this</span>), <span class="variable">false</span>);
			<span class="variable">jo</span>.<span class="variable">screen</span>.<span class="variable">canvas</span>.<span class="variable">addEventListener</span>(<span class="string">'mousedown'</span>, <span class="variable">jo</span>.<span class="variable">bind</span>(<span class="this">this</span>.<span class="variable">keyDown</span>, <span class="this">this</span>), <span class="variable">false</span>);			
			<span class="variable">window</span>.<span class="variable">addEventListener</span>(<span class="string">'mouseup'</span>, <span class="variable">jo</span>.<span class="variable">bind</span>(<span class="this">this</span>.<span class="variable">keyUp</span>, <span class="this">this</span>), <span class="variable">false</span>);
			<span class="variable">window</span>.<span class="variable">addEventListener</span>(<span class="string">'mousemove'</span>, <span class="variable">jo</span>.<span class="variable">bind</span>(<span class="this">this</span>.<span class="variable">mouseMove</span>, <span class="this">this</span>), <span class="variable">false</span>);
			
			<span class="variable">jo</span>.<span class="variable">log</span>(<span class="string">'mouse ready..'</span>);
		},
		<span class="variable">keyUp</span>: <span class="keyword">function</span>(<span class="variable">event</span>){
			<span class="keyword">if</span> (<span class="variable">event</span>.<span class="variable">target</span>.<span class="variable">type</span> == <span class="string">'text'</span>) {
				<span class="keyword">return</span>;
			}
			<span class="keyword">var</span> <span class="variable">code</span> = <span class="variable">event</span>.<span class="variable">type</span> == <span class="string">'keyup'</span> ? <span class="variable">event</span>.<span class="variable">keyCode</span> :(<span class="variable">event</span>.<span class="variable">button</span> == <span class="number integer">2</span> ? <span class="this">this</span>.<span class="class">MOUSE2</span> : <span class="this">this</span>.<span class="class">MOUSE1</span>);
			<span class="keyword">if</span>(<span class="variable">code</span> &<span class="variable">gt</span>;= <span class="number integer">0</span>){
				<span class="this">this</span>.<span class="variable">newKey</span>[<span class="variable">code</span>] = <span class="variable">false</span>;
			}
			<span class="keyword">if</span>(<span class="variable">jo</span>.<span class="variable">includes</span>(<span class="this">this</span>.<span class="variable">reserved</span>, <span class="variable">code</span>) || <span class="variable">event</span>.<span class="variable">type</span> !== <span class="string">'keydown'</span>){
				<span class="variable">event</span>.<span class="variable">preventDefault</span>();
				<span class="keyword">return</span> <span class="number integer">0</span>;
			}
			<span class="comment">//this.clear();</span>
		},
		<span class="variable">keyDown</span>: <span class="keyword">function</span>(<span class="variable">event</span>){
			<span class="keyword">if</span> (<span class="variable">event</span>.<span class="variable">target</span>.<span class="variable">type</span> === <span class="string">'text'</span>) {
				<span class="keyword">return</span>;
			}
			<span class="keyword">var</span> <span class="variable">code</span> = <span class="variable">event</span>.<span class="variable">type</span> === <span class="string">'keydown'</span> ? <span class="variable">event</span>.<span class="variable">keyCode</span> : (<span class="variable">event</span>.<span class="variable">button</span> == <span class="number integer">2</span> ? <span class="this">this</span>.<span class="class">MOUSE2</span> : <span class="this">this</span>.<span class="class">MOUSE1</span>);
			<span class="keyword">if</span>(<span class="variable">code</span>&<span class="variable">gt</span>;= <span class="number integer">0</span>){
				<span class="this">this</span>.<span class="variable">newKey</span>[<span class="variable">code</span>] = <span class="variable">true</span>;
			}
			<span class="keyword">if</span>(<span class="variable">jo</span>.<span class="variable">includes</span>(<span class="this">this</span>.<span class="variable">reserved</span>, <span class="variable">code</span>) || <span class="variable">event</span>.<span class="variable">type</span> !== <span class="string">'keydown'</span>){
				<span class="variable">event</span>.<span class="variable">preventDefault</span>();
				<span class="keyword">return</span> <span class="number integer">0</span>;
			}
		},
		<span class="variable">clearKeys</span>: <span class="keyword">function</span>(){
			<span class="keyword">for</span>(<span class="keyword">var</span> <span class="variable">i</span>=<span class="number integer">0</span>; <span class="variable">i</span>&<span class="variable">lt</span>;<span class="variable">keybuf</span>; <span class="variable">i</span>++){
				<span class="this">this</span>.<span class="variable">key</span>[<span class="variable">i</span>]=<span class="variable">false</span>;
				<span class="this">this</span>.<span class="variable">newKey</span>[<span class="variable">i</span>]=<span class="variable">false</span>;
				<span class="this">this</span>.<span class="variable">lastKey</span>[<span class="variable">i</span>]=<span class="variable">false</span>;
			}
		},
		<span class="variable">mouseMovement</span>: <span class="keyword">function</span>(){
			<span class="keyword">return</span> <span class="this">this</span>.<span class="variable">mouse</span>.<span class="variable">minus</span>(<span class="this">this</span>.<span class="variable">lastMouse</span>);
		},
        <span class="variable">mouseWheel</span>: <span class="keyword">function</span> (<span class="variable">event</span>) {
            <span class="keyword">var</span> <span class="variable">code</span> = <span class="variable">event</span>.<span class="variable">wheel</span> &<span class="variable">gt</span>; <span class="number integer">0</span> ? <span class="this">this</span>.<span class="class">WHEEL_UP</span> : <span class="this">this</span>.<span class="class">WHEEL_DOWN</span>;
			<span class="keyword">if</span>(<span class="variable">jo</span>.<span class="variable">includes</span>(<span class="this">this</span>.<span class="variable">reserved</span>, <span class="variable">code</span>)){
				<span class="variable">event</span>.<span class="variable">preventDefault</span>();
			}
			<span class="keyword">if</span>(<span class="variable">code</span>&<span class="variable">gt</span>;= <span class="number integer">0</span>){
				<span class="this">this</span>.<span class="variable">key</span>[<span class="variable">code</span>]=<span class="variable">true</span>;
			}
        },
        <span class="variable">mouseMove</span>: <span class="keyword">function</span> (<span class="variable">event</span>) {
            <span class="this">this</span>.<span class="variable">newMouse</span>.<span class="variable">x</span> = (<span class="variable">event</span>.<span class="variable">pageX</span> - <span class="variable">jo</span>.<span class="variable">screen</span>.<span class="variable">offset</span>.<span class="variable">x</span>);
            <span class="this">this</span>.<span class="variable">newMouse</span>.<span class="variable">y</span> = (<span class="variable">event</span>.<span class="variable">pageY</span> - <span class="variable">jo</span>.<span class="variable">screen</span>.<span class="variable">offset</span>.<span class="variable">y</span>);
			
        },
        <span class="variable">update</span>: <span class="keyword">function</span>(<span class="variable">ticks</span>){
            <span class="this">this</span>.<span class="variable">lastMouse</span>.<span class="variable">copy</span>(<span class="this">this</span>.<span class="variable">mouse</span>);
            <span class="this">this</span>.<span class="variable">mouse</span>.<span class="variable">copy</span>(<span class="this">this</span>.<span class="variable">newMouse</span>);
            <span class="keyword">for</span>(<span class="keyword">var</span> <span class="variable">i</span>=<span class="number integer">0</span>; <span class="variable">i</span>&<span class="variable">lt</span>; <span class="variable">keybuf</span>; <span class="variable">i</span>++){
                <span class="this">this</span>.<span class="variable">lastKey</span>[<span class="variable">i</span>]= <span class="this">this</span>.<span class="variable">key</span>[<span class="variable">i</span>];
                <span class="this">this</span>.<span class="variable">key</span>[<span class="variable">i</span>] = <span class="this">this</span>.<span class="variable">newKey</span>[<span class="variable">i</span>];
            }
        },
        <span class="variable">once</span>: <span class="keyword">function</span>(<span class="variable">key</span>){
        	<span class="keyword">var</span> <span class="variable">code</span> = <span class="this">this</span>[<span class="variable">key</span>];
        	<span class="keyword">return</span> !<span class="this">this</span>.<span class="variable">lastKey</span>[<span class="variable">code</span>] &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="this">this</span>.<span class="variable">key</span>[<span class="variable">code</span>];
        },
        <span class="variable">contextMenu</span>: <span class="keyword">function</span> (<span class="variable">event</span>) {
            <span class="keyword">if</span> (<span class="variable">jo</span>.<span class="variable">includes</span>(<span class="this">this</span>.<span class="variable">reserved</span>, <span class="this">this</span>.<span class="class">MOUSE2</span>)){
                <span class="variable">event</span>.<span class="variable">stopPropagation</span>();
                <span class="variable">event</span>.<span class="variable">preventDefault</span>();
            }
        },
        <span class="variable">k</span>: <span class="keyword">function</span>(<span class="variable">key</span>){
        	<span class="keyword">return</span> <span class="this">this</span>.<span class="variable">key</span>[<span class="this">this</span>[<span class="variable">key</span>]] === <span class="variable">true</span>;
        }
	};
	<span class="keyword">return</span> <span class="variable">jo</span>.<span class="variable">input</span>;
});</code></pre>
</td>
</tr><tr class="filename"><td><h2 id="jo.js"><a href="#">jo</a></h2></td><td>jo.js</td></tr><tr class="code">
<td class="docs">
<ul><li><p><strong>name</strong>: <em>jo</em></p></li><li><p><strong>namespace</strong>: <em>the</em>
namespace of the jomoho library</p></li></ul>
</td>
<td class="code">
<pre><code><span class="variable">define</span>([<span class="string">'./Class'</span>, <span class="string">'./Mersenne'</span>],<span class="keyword">function</span>(<span class="class">Class</span>, <span class="class">Mersenne</span>){
	<span class="keyword">return</span> {</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * @constant 
	 * @description version string
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">version</span>: <span class="string">'0.1'</span>,
		
		<span class="class">Class</span>: <span class="class">Class</span>,
		
		<span class="class">Mersenne</span>: <span class="class">Mersenne</span>,
		<span class="variable">random</span>: <span class="keyword">new</span> <span class="class">Mersenne</span>(),</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * logs into the console if available
	 * @param what
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">log</span> : <span class="keyword">function</span>(<span class="variable">what</span>) {
			<span class="keyword">if</span> (<span class="keyword">typeof</span> (<span class="variable">console</span>) !== <span class="string">'undefined'</span>) {
				<span class="variable">console</span>.<span class="variable">log</span>(<span class="variable">what</span>);
			}
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * 
	 * @param r
	 * @param g
	 * @param b
	 * @param a
	 * @returns {String}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">color</span> : <span class="keyword">function</span>(<span class="variable">r</span>, <span class="variable">g</span>, <span class="variable">b</span>, <span class="variable">a</span>){
			<span class="variable">r</span> = <span class="class">Math</span>.<span class="variable">floor</span>(<span class="variable">r</span>);
			<span class="variable">g</span> = <span class="class">Math</span>.<span class="variable">floor</span>(<span class="variable">g</span>);
			<span class="variable">b</span> = <span class="class">Math</span>.<span class="variable">floor</span>(<span class="variable">b</span>);
			

			<span class="keyword">if</span> (<span class="keyword">typeof</span> (<span class="variable">a</span>) === <span class="string">'undefined'</span>){
				<span class="keyword">return</span> <span class="string">'rgb('</span> + <span class="variable">r</span> + <span class="string">','</span> + <span class="variable">g</span> + <span class="string">','</span> + <span class="variable">b</span> + <span class="string">')'</span>;
			} <span class="keyword">else</span> {
				<span class="variable">a</span> = <span class="class">Math</span>.<span class="variable">floor</span>(<span class="variable">a</span>);
				<span class="keyword">return</span> <span class="string">'rgba('</span> + <span class="variable">r</span> + <span class="string">','</span> + <span class="variable">g</span> + <span class="string">','</span> + <span class="variable">b</span> + <span class="string">','</span> + <span class="variable">a</span> + <span class="string">')'</span>;
			}
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * maps an index of range a to b to an index of x to y
	 * @param i
	 * @param a
	 * @param b
	 * @param x
	 * @param y
	 * @returns
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">mapto</span> : <span class="keyword">function</span>(<span class="variable">i</span>, <span class="variable">a</span>, <span class="variable">b</span>, <span class="variable">x</span>, <span class="variable">y</span>) {
			<span class="keyword">var</span> <span class="variable">l1</span> = <span class="variable">b</span> - <span class="variable">a</span>;
			<span class="keyword">var</span> <span class="variable">l2</span> = <span class="variable">y</span> - <span class="variable">x</span>;

			<span class="keyword">return</span> (((<span class="variable">i</span> - <span class="variable">a</span>) / <span class="variable">l1</span>) * <span class="variable">l2</span>) + <span class="variable">x</span>;
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * takes a member name string and returns a comparison function, to be used with array.sort
	 * @param name
	 * @returns
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">sortby</span> : <span class="keyword">function</span>(<span class="variable">name</span>) {
			<span class="keyword">return</span> <span class="keyword">function</span>(<span class="variable">o</span>, <span class="variable">p</span>) {
				<span class="keyword">var</span> <span class="variable">a</span>, <span class="variable">b</span>;
				<span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable">o</span> === <span class="string">'object'</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="keyword">typeof</span> <span class="variable">p</span> === <span class="string">'object'</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">o</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">p</span>) {
					<span class="variable">a</span> = <span class="variable">o</span>[<span class="variable">name</span>];
					<span class="variable">b</span> = <span class="variable">p</span>[<span class="variable">name</span>];
					<span class="keyword">if</span> (<span class="variable">a</span> === <span class="variable">b</span>) {
						<span class="keyword">return</span> <span class="number integer">0</span>;
					}
					<span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable">a</span> === <span class="keyword">typeof</span> <span class="variable">b</span>) {
						<span class="keyword">return</span> <span class="variable">a</span> &<span class="variable">lt</span>; <span class="variable">b</span> ? -<span class="number integer">1</span> : <span class="number integer">1</span>;
					}
					<span class="keyword">return</span> <span class="keyword">typeof</span> <span class="variable">a</span> &<span class="variable">lt</span>; <span class="keyword">typeof</span> <span class="variable">b</span> ? -<span class="number integer">1</span> : <span class="number integer">1</span>;
				} <span class="keyword">else</span> {
					<span class="keyword">throw</span> {
						<span class="variable">name</span> : <span class="string">'Error'</span>,
						<span class="variable">message</span> : <span class="string">'Expected an object when sorting by '</span> + <span class="variable">name</span>
					};
				}
			};
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * binds fn to an object
	 * @param {Function} fn
	 * @param object
	 * @returns {Function}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">bind</span>: <span class="keyword">function</span>(<span class="variable">fn</span>, <span class="variable">obj</span>){
			<span class="keyword">return</span> <span class="keyword">function</span>() {
				<span class="variable">fn</span>.<span class="variable">apply</span>(<span class="variable">obj</span>, <span class="variable">arguments</span>);
			};
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * returns true if set contains element
	 * @param {Array} set
	 * @param element
	 * @returns {Boolean}
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">includes</span>: <span class="keyword">function</span>(<span class="variable">set</span>, <span class="variable">element</span>) {

			<span class="keyword">for</span> ( <span class="keyword">var</span> <span class="variable">i</span> = <span class="number integer">0</span>; <span class="variable">i</span> &<span class="variable">lt</span>; <span class="variable">set</span>.<span class="variable">length</span>; <span class="variable">i</span>++) {
				<span class="keyword">if</span> (<span class="variable">set</span>[<span class="variable">i</span>] === <span class="variable">element</span>) {
					<span class="keyword">return</span> <span class="variable">true</span>;
				}
			}
			<span class="keyword">return</span> <span class="variable">false</span>;		
		},
		<span class="variable">incl</span>: <span class="keyword">function</span>(<span class="variable">set</span>, <span class="variable">element</span>) {
			<span class="keyword">var</span> <span class="variable">r</span> = <span class="variable">set</span>.<span class="variable">length</span>&<span class="variable">gt</span>;<span class="number integer">0</span>;
			<span class="keyword">for</span> ( <span class="keyword">var</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="variable">element</span>) {
				<span class="variable">r</span> = <span class="variable">r</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="this">this</span>.<span class="variable">includes</span>(<span class="variable">set</span>, <span class="variable">element</span>[<span class="variable">i</span>]);
			}
			<span class="keyword">return</span> <span class="variable">r</span>;		
		},</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<pre><code>	 * returns a filtered array, does not change array
	 * the filter works by returning true for those elements that should be in the filtered array
	 * @param array
	 * @param filter
	 * @returns
	 </code></pre>
</td>
<td class="code">
<pre><code><span class="variable">filter</span>: <span class="keyword">function</span>(<span class="variable">array</span>, <span class="variable">filter</span>){
			<span class="keyword">var</span> <span class="variable">ret</span> =[];
			<span class="keyword">for</span>(<span class="keyword">var</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="variable">array</span>){
				<span class="keyword">if</span>(<span class="variable">filter</span>(<span class="variable">array</span>[<span class="variable">i</span>])){
					<span class="variable">ret</span>.<span class="variable">push</span>(<span class="variable">array</span>[<span class="variable">i</span>]);
				}
			}
			<span class="keyword">return</span> <span class="variable">ret</span>;
		},
		
		<span class="variable">clr</span>: {
			<span class="variable">white</span>: <span class="string">'rgb(255,255,255)'</span>,
			<span class="variable">red</span>: <span class="string">'rgb(255,0,0)'</span>,
			<span class="variable">green</span>: <span class="string">'rgb(0,255,0)'</span>,
			<span class="variable">blue</span>: <span class="string">'rgb(0,0,255)'</span>,
			<span class="variable">magenta</span>: <span class="string">'rgb(255,0,255)'</span>,
			<span class="variable">cyan</span>: <span class="string">'rgb(0,255,255)'</span>,
			<span class="variable">yellow</span>: <span class="string">'rgb(255,255,0)'</span>,
			<span class="variable">black</span>: <span class="string">'rgb(0,0,0)'</span>
		}
	};
	
});</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<h2>TODO</h2>

<h2>AliceBlue '#F0F8FF',</h2>

<h2>AntiqueWhite '#FAEBD7',</h2>

<h2>Aqua '#00FFFF',</h2>

<h2>Aquamarine '#7FFFD4',</h2>

<h2>Azure '#F0FFFF',</h2>

<h2>Beige '#F5F5DC',</h2>

<h2>Bisque '#FFE4C4',</h2>

<h2>Black '#000000',</h2>

<h2>BlanchedAlmond '#FFEBCD',</h2>

<h2>Blue '#0000FF',</h2>

<h2>BlueViolet '#8A2BE2',</h2>

<h2>Brown '#A52A2A',</h2>

<h2>BurlyWood '#DEB887',</h2>

<h2>CadetBlue '#5F9EA0',</h2>

<h2>Chartreuse '#7FFF00',</h2>

<h2>Chocolate '#D2691E',</h2>

<h2>Coral '#FF7F50',</h2>

<h2>CornflowerBlue '#6495ED',</h2>

<h2>Cornsilk '#FFF8DC',</h2>

<h2>Crimson '#DC143C',</h2>

<h2>Cyan '#00FFFF',</h2>

<h2>DarkBlue '#00008B',</h2>

<h2>DarkCyan '#008B8B',</h2>

<h2>DarkGoldenRod '#B8860B',</h2>

<h2>DarkGray '#A9A9A9',</h2>

<h2>DarkGrey '#A9A9A9',</h2>

<h2>DarkGreen '#006400',</h2>

<h2>DarkKhaki '#BDB76B',</h2>

<h2>DarkMagenta '#8B008B',</h2>

<h2>DarkOliveGreen '#556B2F',</h2>

<h2>Darkorange '#FF8C00',</h2>

<h2>DarkOrchid '#9932CC',</h2>

<h2>DarkRed '#8B0000',</h2>

<h2>DarkSalmon '#E9967A',</h2>

<h2>DarkSeaGreen '#8FBC8F',</h2>

<h2>DarkSlateBlue '#483D8B',</h2>

<h2>DarkSlateGray '#2F4F4F',</h2>

<h2>DarkSlateGrey '#2F4F4F',</h2>

<h2>DarkTurquoise '#00CED1',</h2>

<h2>DarkViolet '#9400D3',</h2>

<h2>DeepPink '#FF1493',</h2>

<h2>DeepSkyBlue '#00BFFF',</h2>

<h2>DimGray '#696969',</h2>

<h2>DimGrey '#696969',</h2>

<h2>DodgerBlue '#1E90FF',</h2>

<h2>FireBrick '#B22222',</h2>

<h2>FloralWhite '#FFFAF0',</h2>

<h2>ForestGreen '#228B22',</h2>

<h2>Fuchsia '#FF00FF',</h2>

<h2>Gainsboro '#DCDCDC',</h2>

<h2>GhostWhite '#F8F8FF',</h2>

<h2>Gold '#FFD700',</h2>

<h2>GoldenRod '#DAA520',</h2>

<h2>Gray '#808080',</h2>

<h2>Grey '#808080',</h2>

<h2>Green '#008000',</h2>

<h2>GreenYellow '#ADFF2F',</h2>

<h2>HoneyDew '#F0FFF0',</h2>

<h2>HotPink '#FF69B4',</h2>

<h2>IndianRed  '#CD5C5C',</h2>

<h2>Indigo  '#4B0082',</h2>

<h2>Ivory '#FFFFF0',</h2>

<h2>Khaki '#F0E68C',</h2>

<h2>Lavender '#E6E6FA',</h2>

<h2>LavenderBlush '#FFF0F5',</h2>

<h2>LawnGreen '#7CFC00',</h2>

<h2>LemonChiffon '#FFFACD',</h2>

<h2>LightBlue '#ADD8E6',</h2>

<h2>LightCoral '#F08080',</h2>

<h2>LightCyan '#E0FFFF',</h2>

<h2>LightGoldenRodYellow '#FAFAD2',</h2>

<h2>LightGray '#D3D3D3',</h2>

<h2>LightGrey '#D3D3D3',</h2>

<h2>LightGreen '#90EE90',</h2>

<h2>LightPink '#FFB6C1',</h2>

<h2>LightSalmon '#FFA07A',</h2>

<h2>LightSeaGreen '#20B2AA',</h2>

<h2>LightSkyBlue '#87CEFA',</h2>

<h2>LightSlateGray '#778899',</h2>

<h2>LightSlateGrey '#778899',</h2>

<h2>LightSteelBlue '#B0C4DE',</h2>

<h2>LightYellow '#FFFFE0',</h2>

<h2>Lime '#00FF00',</h2>

<h2>LimeGreen '#32CD32',</h2>

<h2>Linen '#FAF0E6',</h2>

<h2>Magenta '#FF00FF',</h2>

<h2>Maroon '#800000',</h2>

<h2>MediumAquaMarine '#66CDAA',</h2>

<h2>MediumBlue '#0000CD',</h2>

<h2>MediumOrchid '#BA55D3',</h2>

<h2>MediumPurple '#9370D8',</h2>

<h2>MediumSeaGreen '#3CB371',</h2>

<h2>MediumSlateBlue '#7B68EE',</h2>

<h2>MediumSpringGreen '#00FA9A',</h2>

<h2>MediumTurquoise '#48D1CC',</h2>

<h2>MediumVioletRed '#C71585',</h2>

<h2>MidnightBlue '#191970',</h2>

<h2>MintCream '#F5FFFA',</h2>

<h2>MistyRose '#FFE4E1',</h2>

<h2>Moccasin '#FFE4B5',</h2>

<h2>NavajoWhite '#FFDEAD',</h2>

<h2>Navy '#000080',</h2>

<h2>OldLace '#FDF5E6',</h2>

<h2>Olive '#808000',</h2>

<h2>OliveDrab '#6B8E23',</h2>

<h2>Orange '#FFA500',</h2>

<h2>OrangeRed '#FF4500',</h2>

<h2>Orchid '#DA70D6',</h2>

<h2>PaleGoldenRod '#EEE8AA',</h2>

<h2>PaleGreen '#98FB98',</h2>

<h2>PaleTurquoise '#AFEEEE',</h2>

<h2>PaleVioletRed '#D87093',</h2>

<h2>PapayaWhip '#FFEFD5',</h2>

<h2>PeachPuff '#FFDAB9',</h2>

<h2>Peru '#CD853F',</h2>

<h2>Pink '#FFC0CB',</h2>

<h2>Plum '#DDA0DD',</h2>

<h2>PowderBlue '#B0E0E6',</h2>

<h2>Purple '#800080',</h2>

<h2>Red '#FF0000',</h2>

<h2>RosyBrown '#BC8F8F',</h2>

<h2>RoyalBlue '#4169E1',</h2>

<h2>SaddleBrown '#8B4513',</h2>

<h2>Salmon '#FA8072',</h2>

<h2>SandyBrown '#F4A460',</h2>

<h2>SeaGreen '#2E8B57',</h2>

<h2>SeaShell '#FFF5EE',</h2>

<h2>Sienna '#A0522D',</h2>

<h2>Silver '#C0C0C0',</h2>

<h2>SkyBlue '#87CEEB',</h2>

<h2>SlateBlue '#6A5ACD',</h2>

<h2>SlateGray '#708090',</h2>

<h2>SlateGrey '#708090',</h2>

<h2>Snow '#FFFAFA',</h2>

<h2>SpringGreen '#00FF7F',</h2>

<h2>SteelBlue '#4682B4',</h2>

<h2>Tan '#D2B48C',</h2>

<h2>Teal '#008080',</h2>

<h2>Thistle '#D8BFD8',</h2>

<h2>Tomato '#FF6347',</h2>

<h2>Turquoise '#40E0D0',</h2>

<h2>Violet '#EE82EE',</h2>

<h2>Wheat '#F5DEB3',</h2>

<h2>White '#FFFFFF',</h2>

<h2>WhiteSmoke '#F5F5F5',</h2>

<h2>Yellow '#FFFF00',</h2>

<h2>YellowGreen '#9ACD32'</h2>
</td>
<td class="code">

</td>
</tr><tr class="filename"><td><h2 id="math2d.js"><a href="#">math2d</a></h2></td><td>math2d.js</td></tr><tr class="code">
<td class="docs">
<p>define(['./jo', './Point'], function(jo, Point){</p>

<pre><code>jo.math2d = {
		Point: Point,
		Circle: function(center, radius){
			this.x = center.x;
			this.y = center.y;
			this.radius = radius;
		},
		Box: function(topleft, width, height){
			this.pos.copy(topleft);
			this.width = width;
			this.height = height;
		},
		Polygon: function(points){
			this.points = points;
			this.lines = [];
			for(var i = 0; i&lt; points.length-1; i++){
				this.lines.push(new jo.math2d.Line(points[i], points[i+1]));
			}
			this.lines.push(new jo.math2d.Line(points[points.length-1], points[0]));
		},
		Line: function(a, b){
			this.a = a.clone();				
			this.b = b.clone();
			this.direction = function(){
				return a.dif(b);
			};
		},
		intersect: {				
			circleCircle: function (a, b){
				return (a.x-b.x)*(a.x-b.x)+(a.y-b.y)*(a.y-b.y) &lt; Math.pow(a.radius+b.radius,2);
			},
			pointCircle: function(point, circle){
				return Math.pow(point.x-circle.x, 2)+Math.pow(point.y-circle.y, 2) &lt;= Math.pow(circle.radius,2);
			},
			pointBox: function(p, b){
				return this.boxBox({pos: p, width:0, height:0}, b);
			},
			boxBox: function(a, b){
				var a_right = a.pos.x + a.width,
					a_bottom = a.pos.y + a.height,
					b_right = b.pos.x + b.width,
					b_bottom = b.pos.y + b.height;

				if(a_right &lt; b.pos.x || b_right &lt; a.pos.x)
					return false;
				if(a_bottom &lt; b.pos.y || b_bottom &lt; a.pos.y)
					return false;</code></pre>
</td>
<td class="code">
<pre><code>
					<span class="keyword">if</span>( <span class="variable">a_right</span> &<span class="variable">gt</span>; <span class="variable">b</span>.<span class="variable">pos</span>.<span class="variable">x</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">a</span>.<span class="variable">pos</span>.<span class="variable">x</span> &<span class="variable">lt</span>; <span class="variable">b_right</span>){ 		<span class="comment">//vertical voronois</span>
						
						<span class="keyword">if</span>(<span class="variable">a</span>.<span class="variable">pos</span>.<span class="variable">y</span> &<span class="variable">lt</span>; <span class="variable">b</span>.<span class="variable">pos</span>.<span class="variable">y</span> ){					<span class="comment">//above</span>
							<span class="keyword">return</span> {<span class="variable">dir</span>: <span class="string">'top'</span>, <span class="variable">depth</span>: <span class="variable">a_bottom</span> - <span class="variable">b</span>.<span class="variable">pos</span>.<span class="variable">y</span>};
						}<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">a</span>.<span class="variable">pos</span>.<span class="variable">y</span> &<span class="variable">gt</span>; <span class="variable">b_bottom</span> ){			<span class="comment">//below</span>
							<span class="keyword">return</span> {<span class="variable">dir</span>: <span class="string">'bottom'</span>, <span class="variable">depth</span>:(<span class="variable">b_bottom</span>)- (<span class="variable">a</span>.<span class="variable">pos</span>.<span class="variable">y</span>)};
						}
					}<span class="keyword">else</span> <span class="keyword">if</span>( <span class="variable">a_bottom</span> &<span class="variable">gt</span>; <span class="variable">b</span>.<span class="variable">pos</span>.<span class="variable">y</span> &<span class="variable">amp</span>;&<span class="variable">amp</span>; <span class="variable">a</span>.<span class="variable">pos</span>.<span class="variable">y</span> &<span class="variable">lt</span>; <span class="variable">b_bottom</span>){<span class="comment">//horizontal voronois</span>
						
						<span class="keyword">if</span>(<span class="variable">a</span>.<span class="variable">pos</span>.<span class="variable">x</span> &<span class="variable">lt</span>; <span class="variable">b</span>.<span class="variable">pos</span>.<span class="variable">x</span> ){					<span class="comment">//left</span>
							<span class="keyword">return</span> {<span class="variable">dir</span>:<span class="string">'left'</span>,<span class="variable">depth</span>: <span class="variable">a_right</span> - <span class="variable">b</span>.<span class="variable">pos</span>.<span class="variable">x</span>};
						}<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">a</span>.<span class="variable">pos</span>.<span class="variable">x</span> &<span class="variable">gt</span>; <span class="variable">b_right</span> ){			<span class="comment">//right</span>
							<span class="keyword">return</span> {<span class="variable">dir</span>:<span class="string">'right'</span>,<span class="variable">depth</span>:(<span class="variable">b_right</span>) - (<span class="variable">a</span>.<span class="variable">pos</span>.<span class="variable">x</span>)};
						}						
					}</code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>return true;</p>

<pre><code>			},

			lineLine: function(line1, line2){

			},
			lineCircle: function(line, circle){

			},
			polygonPolygon: function(a, b){

			},
			polygonCircle: function(polygon, circle){

			},</code></pre>
</td>
<td class="code">
<pre><code>*<span class="variable">todo</span></code></pre>
</td>
</tr>
<tr class="code">
<td class="docs">
<p>boxPolygon: function(box, polygon){
					return jo.math2d.intersect.polygonPolygon(
							[new Point(box.pos.x, box.y),
					         new Point(box.x + box.width, box.y),
					         new Point(box.x + box.width, box.y + box.height) ,
					         new Point(box.x, box.y + box.height)], polygon);
				},
				boxCircle: function(box, circle){
					return jo.math2d.intersect.polygonCircle(
							[new Point(box.x, box.y),
					         new Point(box.x + box.width, box.y),
					         new Point(box.x + box.width, box.y + box.height) ,
					         new Point(box.x, box.y + box.height)], circle);
				}</p>

<pre><code>		}
};

return jo.math2d;</code></pre>

<p>});</p>
</td>
<td class="code">

</td>
</tr>	</body>
</html></tbody></table>
